<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.0.37">

  <title>ALDA2022 - MLM</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">MLM</h1>
</section>

<section id="ways-to-think-about-mlms" class="slide level2">
<h2>4 ways to think about MLMs</h2>
<ol type="1">
<li>Different levels of analysis (average/person specific or between/within)<br>
</li>
<li>Regressions within regressions (ie coefficients as outcomes)<br>
</li>
<li>Variance decomposition<br>
</li>
<li>Learning from other data through pooling/shrinkage</li>
</ol>
</section>
<section id="standard-regression" class="slide level2">
<h2>Standard regression</h2>
<p><span class="math display">\[{Y}_{i} = b_{0} + b_{1}X_{1} + b_{2}X_{2} + b_{3}X_{3}+... +\epsilon_{i}\]</span></p>
<p><span class="math display">\[\hat{Y}_{i} = b_{0} + b_{1}X_{1} + b_{2}X_{2} + b_{3}X_{3}+...\]</span></p>
<p>Parameters are considered fixed where one regression value corresponds to everyone. I.e., that association between X1 and Y is the same for everyone.</p>
<p>Each person has a Y, denoted by the subscript i, and each has a residual associated with them, also designated by i.</p>
</section>
<section id="handling-multiple-dvs" class="slide level2">
<h2>Handling multiple DVs?</h2>
<p>But what if people had more than 1 DV, like we do with time? What do you do with multiple items, multiple trials, multiple ____ ?</p>
<p>Two options: 1. Collapse and average across.</p>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<div class="cell">

</div>

<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<h3 id="could-aggragate-across-group">could aggragate across group</h3>
<div class="cell">

</div>

<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">


<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section id="aggregation-obscures-hypotheses" class="slide level2">
<h2>Aggregation obscures hypotheses</h2>
<ul>
<li><p>Between person H1: Do students who study more get better grades?</p></li>
<li><p>Within person H2: When a student studies, do they get better grades?</p></li>
<li><p>H1 and H2 are independent from one another! Aggregation collapses the two. When you have nested data with many DVs (longitudinal but also almost any experimental situation) it is important to not aggregate.</p></li>
</ul>
</section>
<section class="slide level2">

<h3 id="stroop-example">Stroop example</h3>
<p>We calculate stroop scores by looking at repeated trials of congruent vs not congruent. This is dummy coded such that the <span class="math inline">\(\beta_{1}\)</span> reflects the average stroop effect. How much slower are people in incongruent trials?</p>
<p><span class="math display">\[Y_{i} = \beta_{0} + \beta_{1}X_{1} + \varepsilon_i\]</span></p>
</section>
<section class="slide level2">

<p>What if we ran a separate regression for everyone? We can then think of <span class="math inline">\(\beta_{1}\)</span> as a PERSON SPECIFIC EFFECT. What is the stoop effect for you?</p>
<p>We could think of <span class="math inline">\(\beta_{1}\)</span> as a random variable where people deviate on stroop effect from the average (ie fixed effect). You can then treat this as a regression, complete with a residual.</p>
<p><span class="math display">\[\beta_{1} = \gamma_{10} +\gamma_{11}Z_i+ U_{1i}\]</span></p>
</section>
<section id="regressions-within-regressions" class="slide level2">
<h2>regressions within regressions</h2>
<p>Helps to take multilevel and split it into the different levels.</p>
<p>Level 1 is the smallest unit of analysis (students, waves, trials, family members)</p>
<p>Level 2 variables are what level 1 variables are “nested” in (people, schools, counties, families, dyads)</p>
<p>We are going to use level one components to run a regression, all the while level 1 is also estimating a regression</p>
</section>
<section class="slide level2">

<p><span class="math display">\[Y_{trials, i} = \beta_{0i} + \beta_{1i}X_{trial,i} + \varepsilon_{trial,i}\]</span></p>
<p><span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span> <span class="math display">\[\beta_{1} = \gamma_{10} +\gamma_{11}Age_i+ U_{1i}\]</span></p>
<p>Our B1 coefficient indexes the stroop effect. However, people differ on this stroop effect. There is some average effect (fixed effect) that people vary around. Each person has some personal <span class="math inline">\(\beta_1\)</span>, which we find using Level 1 data. From there we can also ask questions (with regressions) about that random variable.</p>
</section>
<section class="slide level2">

<p>People differ on the stroop.</p>

<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">


<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch"></section>
<section id="diferent-levels-and-regressions-within-regressions" class="slide level2">
<h2>diferent levels and regressions within regressions</h2>
<p>To sum up the first two ways to think about regression, we take a relationship that could be simplified by aggregation, but instead we ask regression questions at different levels of analysis.</p>
<p>At level 1 we can ask lower-unit questions e.g., if trials are nested within person, what predicts lengthier trials?</p>
<p>Longitudinally, if level 1 is observations, then we can ask level 1/observation level questions like if you’re with people do you then feel happier</p>
</section>
<section class="slide level2">

<p>At level 2 we can ask broader-unit questions. E.g., is age associated with stroop differences</p>
<p>Longitudinally, if level 2 is people, then we can ask level 2/person level questions like if you have more social support are you happier</p>
<p>Both levels are simple regressions. Level 2 uses coefficients from level 1 as DVs. Level 1 variables are time varying, level 2 variables are time invariant</p>
</section>
<section id="variance-decomposition" class="slide level2">
<h2>variance decomposition</h2>
<p>For standard regression, we think of error as existing in one big bucket called <span class="math inline">\(\varepsilon\)</span> . Everything that we do not know goes into that bucket, from measurement error to unmeasured important factors.</p>
<p>For MLMs we will be breaking up ( <span class="math inline">\(\varepsilon\)</span> ) into multiple buckets. These useful “buckets” (Us) are what we refer to as random/varying effects.</p>
<p><span class="math display">\[Y_{trials, i} = \beta_{0i} + \beta_{1i}X_{trial,i} + \varepsilon_{trial}\]</span> <span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span> <span class="math display">\[\beta_{1} = \gamma_{10} +\gamma_{11}Z_i+ U_{1i}\]</span></p>
</section>
<section class="slide level2">

<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="btw.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="win.png"></p>
</div>
</div>
</section>
<section class="slide level2">

<p>Random effects used to be error, but they are going to be useful going forward.</p>
<p>We will treat them as variables themselves e.g.&nbsp;individual differences in how people change</p>
<p>They index how much people DIFFER on some effect. e.g.&nbsp;does everyone change the same, or are there differences in how people change?</p>
<p>We can relate the random effects to other random effects e.g., do people who increase on X also start higher on X.</p>
</section>
<section id="shrinkagepartial-pooling" class="slide level2">
<h2>shrinkage/partial pooling</h2>
<ul>
<li><p>We treat our group variable as coming from a population. All groups are alike (because they are from the same population), but different in their own way. Because of this it is helpful to use information from other groups to help make predictions.</p></li>
<li><p>We do this in standard regression where we make predictions based on values from the whole dataset (not just binned Xs). A similar analogy for MLM is running a regression for each group. We want to pool as this leads to better predictions as we are not overfitting our data!</p></li>
</ul>
</section>
<section class="slide level2">

<p>If we take our simplified stroop effect model, where we are only looking at reaction time as a DV (ignoring the different types of trials) we could fit a model like this (an empty model)</p>
<p><span class="math display">\[Y_{trials, i} = \beta_{0i} +  \varepsilon_{trial}\]</span></p>
<p><span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span></p>
<p>Where does <span class="math inline">\(U_{0i}\)</span> come from? If we calculated each by hand, through taking the average reaction time for a person i and subtracting that from the grand mean reaction time, would that equal <span class="math inline">\(U_{0i}\)</span> ?</p>
</section>
<section id="complete-partial-and-no-pooling" class="slide level2">
<h2>Complete, partial and no pooling</h2>
<ul>
<li><p>Complete assumes everyone is the same, with <span class="math inline">\(U_{0i}\)</span> being zero for everyone.</p></li>
<li><p>No pooling is if we calculate every person’s effect with a regression, subtracting out he grand mean average.</p></li>
<li><p>Partial pooling is in the middle, a weighted average between the two. For those with fewer trials there is less information for a particular individual, thus the complete pooling estimate will be given more weight. If someone has a lot of data, there weighted average is closer to no pooling.</p></li>
<li><p>Partial pooling prevents both over and under fitting of your data, leading to increased out of sample predictions.</p></li>
</ul>
</section>
<section id="basic-longitudinal-models" class="slide level2">
<h2>Basic Longitudinal Models</h2>
<p>To keep with the book, we are going to discuss DVs that take on different values at each timepoint t, for individual i <span class="math inline">\({Y}_{ti}\)</span> Other naming schemes are equivalent such as the same <span class="math inline">\({Y}_{ij}\)</span> where i’s are nested in j groups.</p>
</section>
<section id="empty-model" class="slide level2">
<h2>Empty model</h2>
<p>Level 1 <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \varepsilon_{ti}\]</span></p>
<p>Level 2 <span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span></p>
<p><span class="math display">\[{e}_{ti} \sim \mathcal{N}(0, \sigma^{2})\]</span></p>
<p><span class="math display">\[{U}_{0i} \sim \mathcal{N}(0, \tau_{00}^{2})\]</span></p>
</section>
<section id="what-does-this-look-like" class="slide level2">
<h2>What does this look like?</h2>
<div class="cell">

</div>

<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section>
<section id="combined-equation" class="slide level2">
<h2>combined equation</h2>
<p><span class="math display">\[{Y}_{ti} = \gamma_{00} + U_{0i}  + \varepsilon_{ti}\]</span></p>
<p>Akin to ANOVA if we treat <span class="math inline">\(U_{0i}\)</span> as between subjects variance &amp; <span class="math inline">\(\varepsilon_{ti}\)</span> as within subjects variance.</p>
<ul>
<li><p><span class="math inline">\(\gamma_{00}\)</span> is fixed or constant across people</p></li>
<li><p><span class="math inline">\(U_{0i}\)</span> is random or varies across people</p></li>
</ul>
</section>
<section id="icc" class="slide level2">
<h2>ICC</h2>
<p>Between version variance over total variance. If the ICC is greater than zero, we are breaking standard regression assumptions as this is an index of dependency.</p>
<p><span class="math display">\[\frac{U_{0i}}{U_{0i}+ \varepsilon_{ti}}\]</span></p>
<p>ICC can also be interpreted as the average (or expected) correlation within a nested group, in this case a person. On other words, the ICC is the correlation between any person’s repeated measures (technically residuals).</p>
</section>
<section id="gsoep-example" class="slide level2">
<h2>GSOEP EXAMPLE</h2>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">str</span>(b5_soep_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [151,186 × 6] (S3: tbl_df/tbl/data.frame)
 $ Procedural__SID: num [1:151186] 901 901 901 901 901 901 901 901 901 901 ...
 $ trait          : chr [1:151186] "A" "A" "A" "C" ...
 $ year           : chr [1:151186] "2005" "2009" "2013" "2005" ...
 $ value          : num [1:151186] 4.67 4.33 4.67 5 5 ...
 $ DOB            : num [1:151186] 1951 1951 1951 1951 1951 ...
 $ Sex            : num [1:151186] 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>b5_long <span class="ot">&lt;-</span> b5_soep_long <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> trait, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> Procedural__SID) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.factor</span>(ID))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">str</span>(b5_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [22,098 × 10] (S3: tbl_df/tbl/data.frame)
 $ Procedural__SID: num [1:22098] 901 901 901 2301 2301 ...
 $ year           : chr [1:22098] "2005" "2009" "2013" "2005" ...
 $ DOB            : num [1:22098] 1951 1951 1951 1946 1946 ...
 $ Sex            : num [1:22098] 2 2 2 1 1 1 2 2 2 2 ...
 $ A              : num [1:22098] 4.67 4.33 4.67 5.67 5.67 ...
 $ C              : num [1:22098] 5 5 5 5.67 5 ...
 $ E              : num [1:22098] 5 5 5 5 4 ...
 $ N              : num [1:22098] 4 4.67 4.33 4.33 5.33 ...
 $ O              : num [1:22098] 4 4 3.33 4.33 5 ...
 $ ID             : Factor w/ 16719 levels "901","1202","2301",..: 1 1 1 3 3 3 4 4 4 7 ...</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>mod<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">summary</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: C ~ 1 + (1 | ID)
   Data: b5_long

REML criterion at convergence: 42780.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.2878 -0.4450  0.0563  0.4186  4.7465 

Random effects:
 Groups   Name        Variance Std.Dev.
 ID       (Intercept) 0.1379   0.3713  
 Residual             0.3008   0.5485  
Number of obs: 22081, groups:  ID, 8565

Fixed effects:
            Estimate Std. Error t value
(Intercept) 4.760256   0.005478   868.9</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">library</span>(parameters) </span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="fu">model_parameters</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |       SE |       95% CI | t(22078) |      p
-----------------------------------------------------------------------
(Intercept) |        4.76 | 5.48e-03 | [4.75, 4.77] |   868.91 | &lt; .001

# Random Effects

Parameter          | Coefficient
--------------------------------
SD (Intercept: ID) |        0.37
SD (Residual)      |        0.55</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>ICC By hand or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">library</span>(performance) </span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">model_performance</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
42786.914 | 42786.915 | 42810.922 |      0.314 |      0.000 | 0.314 | 0.488 | 0.548</code></pre>
</div>
</div>
</section>
<section id="what-do-the-random-effects-look-like" class="slide level2">
<h2>what do the random effects look like?</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">library</span>(modelbased)</span>
<span id="cb13-2"><a href="#cb13-2"></a>random <span class="ot">&lt;-</span> <span class="fu">estimate_grouplevel</span>(mod<span class="fl">.1</span>) </span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="fu">head</span>(random)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Group | Level |   Parameter | Coefficient |   SE |        95% CI
----------------------------------------------------------------
ID    |   901 | (Intercept) |        0.14 | 0.24 | [-0.33, 0.61]
ID    |  2301 | (Intercept) |        0.33 | 0.24 | [-0.14, 0.80]
ID    |  2302 | (Intercept) |        0.27 | 0.24 | [-0.20, 0.74]
ID    |  4701 | (Intercept) |       -0.04 | 0.27 | [-0.57, 0.48]
ID    |  4901 | (Intercept) |        0.01 | 0.24 | [-0.46, 0.48]
ID    |  5201 | (Intercept) |        0.59 | 0.24 | [ 0.12, 1.06]</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">library</span>(see)</span>
<span id="cb15-2"><a href="#cb15-2"></a>random <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="fu">sample_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="fu">plot</span>(.) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">theme_lucid</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch"></section>
<section id="base-r-dealing-with-random-effects" class="slide level2">
<h2>base r dealing with random effects</h2>
<p>coef = fixef + raneff</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">glimpse</span>(<span class="fu">ranef</span>(mod<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 1
 $ ID:'data.frame': 8565 obs. of  1 variable:
  ..$ (Intercept): num [1:8565] 0.1388 0.3318 0.2675 -0.0448 0.0101 ...
  ..- attr(*, "postVar")= num [1, 1, 1:8565] 0.0581 0.0581 0.0581 0.0719 0.0581 ...
 - attr(*, "class")= chr "ranef.mer"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">glimpse</span>(<span class="fu">coef</span>(mod<span class="fl">.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 1
 $ ID:'data.frame': 8565 obs. of  1 variable:
  ..$ (Intercept): num [1:8565] 4.9 5.09 5.03 4.72 4.77 ...
 - attr(*, "class")= chr "coef.mer"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">fixef</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   4.760256 </code></pre>
</div>
</div>
</section>
<section id="residuals" class="slide level2">
<h2>Residuals</h2>
<p>To get residuals and fitted scores</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb22-2"><a href="#cb22-2"></a>example.aug<span class="ot">&lt;-</span> <span class="fu">augment</span>(mod<span class="fl">.1</span>, <span class="at">data =</span> b5_long)</span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a>example.aug</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22,081 × 21
   Procedural__SID year    DOB   Sex     A     C     E     N     O ID    .fitted
             &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;
 1             901 2005   1951     2  4.67  5     5     4     4    901      4.90
 2             901 2009   1951     2  4.33  5     5     4.67  4    901      4.90
 3             901 2013   1951     2  4.67  5     5     4.33  3.33 901      4.90
 4            2301 2005   1946     1  5.67  5.67  5     4.33  4.33 2301     5.09
 5            2301 2009   1946     1  5.67  5     4     5.33  5    2301     5.09
 6            2301 2013   1946     1  4.67  5.33  5.33  3.67  5    2301     5.09
 7            2302 2005   1946     2  4.67  4.67  4.67  3.67  5    2302     5.03
 8            2302 2009   1946     2  4     6     5.33  3     4.33 2302     5.03
 9            2302 2013   1946     2  3.33  5     4.67  3     5.67 2302     5.03
10            4701 2005   1919     2  4     4.33  4.67  3.67  3    4701     4.72
# … with 22,071 more rows, and 10 more variables: .resid &lt;dbl&gt;, .hat &lt;dbl&gt;,
#   .cooksd &lt;dbl&gt;, .fixed &lt;dbl&gt;, .mu &lt;dbl&gt;, .offset &lt;dbl&gt;, .sqrtXwt &lt;dbl&gt;,
#   .sqrtrwt &lt;dbl&gt;, .weights &lt;dbl&gt;, .wtres &lt;dbl&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># .fitted    = predicted values</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co"># .resid    = residuals/errors</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co"># .fixed     = predicted values with no random effects</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="predicted-scores" class="slide level2">
<h2>Predicted scores</h2>
<p>Predictors are super important for evaluating our model as well as graphing. Lots of packages have these capabilities. My favorites are tidybayes (for brms), marginaleffects (for all), modelbased (for all) and insight both from easystats.</p>
<p>These extend the flexibility of predict (base) and similar functions from emmeans</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">library</span>(modelbased)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="fu">estimate_prediction</span>(mod<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">head</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model-based Prediction

C    |   ID | Predicted |   SE |       95% CI | Residuals
---------------------------------------------------------
5.00 |  901 |      4.90 | 0.55 | [3.82, 5.97] |      0.10
5.00 |  901 |      4.90 | 0.55 | [3.82, 5.97] |      0.10
5.00 |  901 |      4.90 | 0.55 | [3.82, 5.97] |      0.10
5.67 | 2301 |      5.09 | 0.55 | [4.02, 6.17] |      0.57
5.00 | 2301 |      5.09 | 0.55 | [4.02, 6.17] |     -0.09
5.33 | 2301 |      5.09 | 0.55 | [4.02, 6.17] |      0.24

Variable predicted: C</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">library</span>(insight)</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="fu">get_predicted</span>(mod<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5        6 
4.899059 4.899059 4.899059 5.092048 5.092048 5.092048 </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb29-2"><a href="#cb29-2"></a></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="fu">predictions</span>(mod<span class="fl">.1</span>) <span class="sc">%&gt;%</span>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  rowid     type predicted   std.error statistic p.value conf.low conf.high
1     1 response  4.899059 0.005478406  894.2489       0 4.888321  4.909797
2     2 response  4.899059 0.005478406  894.2489       0 4.888321  4.909797
3     3 response  4.899059 0.005478406  894.2489       0 4.888321  4.909797
4     4 response  5.092048 0.005478406  929.4760       0 5.081309  5.102786
5     5 response  5.092048 0.005478406  929.4760       0 5.081309  5.102786
6     6 response  5.092048 0.005478406  929.4760       0 5.081309  5.102786
         C   ID
1 5.000000  901
2 5.000000  901
3 5.000000  901
4 5.666667 2301
5 5.000000 2301
6 5.333333 2301</code></pre>
</div>
</div>
</section>
<section id="within-person-empty-model" class="slide level2">
<h2>within person empty model</h2>
<p><span class="math display">\[{Y}_{ti} = \gamma_{00} + U_{0i}  + \varepsilon_{ti}\]</span></p>
<p>This model is helpful in producing the simplest longitudinal model, one where it states: there is an average value <span class="math inline">\(\gamma_{00}\)</span> that people differ along <span class="math inline">\(U_{0i}\)</span> . Because time is not in the model it assumes people do not change. <span class="math inline">\(\varepsilon_{ti}\)</span> reflects variation around each person’s predicted score ( <span class="math inline">\(\gamma_{00} + U_{0i}\)</span> ).</p>
</section>
<section id="transitioning-to-longitudinal-applications" class="slide level2">
<h2>transitioning to longitudinal applications</h2>
<p>We are going to fit a simple longitudinal model: a growth model. Growth model is just a fancy term for including TIME as our level 1 predictor where we are now creating lines for each person.</p>
</section>
<section id="a-predictor-in-level-1" class="slide level2">
<h2>A predictor in level 1</h2>
<p>Level 1 is where you have data that repeats within your grouping or clustering data. Is your cluster classrooms? Then students are level 1. People will be our cluster and observations are level 1.</p>
<p><span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}X_{ti} + \varepsilon_{ti}\]</span></p>
<p>Notice on the subscript of X that these predictors vary across cluster (i) and within the cluster (t) So if your clustering (i) is people, then t refers to different observations.</p>
</section>
<section class="slide level2">

<p>Level 2 takes the parameters at level 1 and decomposes them into a fixed component ( <span class="math inline">\(\gamma\)</span> ) that reflects the average and, if desired, the individual deviations around that fixed effect (U).</p>
<p>level 1 <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}X_{ti} + \varepsilon_{ti}\]</span></p>
<p>level 2 <span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span><br>
</p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10}\]</span></p>
</section>
<section class="slide level2">

<p>Notice how if we constrain random effects this just turns into a simple regression</p>
<p>level 1 <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}X_{ti} + \varepsilon_{ti}\]</span></p>
<p>level 2 <span class="math display">\[{\beta}_{0i} = \gamma_{00} \]</span><br>
</p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10}\]</span></p>
</section>
<section class="slide level2">

<p>Combined equation: <span class="math display">\[{Y}_{ti} = \gamma_{00} + \gamma_{10} (X_{1i})+ U_{0i}  + \varepsilon_{ti}\]</span></p>
<p>Because we have a level 1 time predictor in the model, we are now asking the question, how does time influence scores on our DV? Because all regressions are linear by default, it asks if there is an association such that as time increases does the DV? This describes a trajectory.</p>
</section>
<section id="including-a-random-slope" class="slide level2">
<h2>Including a random slope</h2>
<p>level 1 <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}X_{ti} + \varepsilon_{ti}\]</span></p>
<p>level 2 <span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span><br>
</p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10}+ U_{1i}\]</span> combined: <span class="math display">\[{Y}_{ti} = \gamma_{00} + \gamma_{10}(X_{ti})+ U_{0i} + U_{1i}(X_{ti}) + \varepsilon_{ti}\]</span></p>
<p><span class="math display">\[{Y}_{ti} = (\gamma_{00} + U_{0i}) + (\gamma_{10}+  U_{1i})X_{ti} + \varepsilon_{ti}\]</span></p>
</section>
<section class="slide level2">

<ul>
<li><p>By including random effects (U) you making a claim that every group/cluster does <em>not</em> have the same <span class="math inline">\(\gamma\)</span> ie intercept/regression coefficient.</p></li>
<li><p>An advantage of MLM is to separate more “buckets” of variance that are unexplained. What was originally <span class="math inline">\(e_{ti}\)</span> is now ( <span class="math inline">\(U_0\)</span> + <span class="math inline">\(U_1\)</span> + <span class="math inline">\(e_{ti}\)</span> ). This additional decomposition of variance is beneficial because you are separating signal from noise, translating what was noise <span class="math inline">\(e_{ti}\)</span> into meaningful signal ( <span class="math inline">\(U_0\)</span> , <span class="math inline">\(U_1\)</span> , etc).</p></li>
<li><p>E.g., multiple responses per person can identify individual differences that normally would be chalked up to error. If you parse out this error your signal becomes stronger.</p></li>
</ul>
</section>
<section id="person-predictions" class="slide level2">
<h2>person predictions</h2>
<p>Can think of a persons score divided up into a fixed component as well as the random component.</p>
<p><span class="math display">\[{\beta}_{1.26} = \gamma_{10} \pm U_{26}\]</span> Also call BLUPs or empirical bayes estimates</p>
</section>
<section id="slope-example" class="slide level2">
<h2>slope example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>mod<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> year <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="fu">summary</span>(mod<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: C ~ 1 + year + (1 | ID)
   Data: b5_long

REML criterion at convergence: 42793.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.2995 -0.4572  0.0548  0.4152  4.7573 

Random effects:
 Groups   Name        Variance Std.Dev.
 ID       (Intercept) 0.1378   0.3712  
 Residual             0.3009   0.5485  
Number of obs: 22081, groups:  ID, 8565

Fixed effects:
            Estimate Std. Error t value
(Intercept) 4.752544   0.007566 628.165
year2009    0.009782   0.008756   1.117
year2013    0.014584   0.009773   1.492

Correlation of Fixed Effects:
         (Intr) yr2009
year2009 -0.621       
year2013 -0.565  0.488</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>b5_long<span class="ot">&lt;-</span> b5_long <span class="sc">%&gt;%</span>  </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(year))</span>
<span id="cb33-3"><a href="#cb33-3"></a>  </span>
<span id="cb33-4"><a href="#cb33-4"></a>mod<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> year <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span>
<span id="cb33-5"><a href="#cb33-5"></a></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="fu">summary</span>(mod<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: C ~ 1 + year + (1 | ID)
   Data: b5_long

REML criterion at convergence: 42790.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.3016 -0.4591  0.0529  0.4182  4.7556 

Random effects:
 Groups   Name        Variance Std.Dev.
 ID       (Intercept) 0.1378   0.3712  
 Residual             0.3009   0.5485  
Number of obs: 22081, groups:  ID, 8565

Fixed effects:
            Estimate Std. Error t value
(Intercept) 1.034489   2.445847   0.423
year        0.001855   0.001218   1.523

Correlation of Fixed Effects:
     (Intr)
year -1.000</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h3 id="the-importance-of-scaling-time">The importance of scaling time</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>b5_long<span class="ot">&lt;-</span> b5_long <span class="sc">%&gt;%</span>  </span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">mutate</span>(<span class="at">year.c =</span> (year <span class="sc">-</span> <span class="dv">2005</span>))</span>
<span id="cb35-3"><a href="#cb35-3"></a>  </span>
<span id="cb35-4"><a href="#cb35-4"></a>  </span>
<span id="cb35-5"><a href="#cb35-5"></a>mod<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> year.c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span>
<span id="cb35-6"><a href="#cb35-6"></a></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="fu">summary</span>(mod<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: C ~ 1 + year.c + (1 | ID)
   Data: b5_long

REML criterion at convergence: 42790.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.3016 -0.4591  0.0529  0.4182  4.7556 

Random effects:
 Groups   Name        Variance Std.Dev.
 ID       (Intercept) 0.1378   0.3712  
 Residual             0.3009   0.5485  
Number of obs: 22081, groups:  ID, 8565

Fixed effects:
            Estimate Std. Error t value
(Intercept) 4.753403   0.007088 670.621
year.c      0.001855   0.001218   1.523

Correlation of Fixed Effects:
       (Intr)
year.c -0.635</code></pre>
</div>
</div>
</section>
<section id="visualizing-results-quickly" class="slide level2">
<h2>Visualizing results (quickly)</h2>
<p>There are many ways to do this. The parameters package paired with the see package, both from the easystats package, are useful in this regard.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="fu">library</span>(see)</span>
<span id="cb37-3"><a href="#cb37-3"></a></span>
<span id="cb37-4"><a href="#cb37-4"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(mod<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-32-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">simulate_parameters</span>(mod<span class="fl">.4</span>)</span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="fu">plot</span>(result2, <span class="at">show_intercept =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>result3 <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(mod<span class="fl">.4</span>,  <span class="at">group_level =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="fu">plot</span>(result3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<ul>
<li>These graphs however just take your output and make it look nice, in that the same information is still on the results. If we want to say, plot the predicted line we need to do an additional step and FEED the data back into the model. In doing so we create predicted values for each person (or each value of our predictor X), and then can visualize our findings as we would with a regression line.</li>
</ul>
<p>The logic is simple: 1. fit model. 2. create grid that defines points to plot 3. feed grid into model to create predictions</p>
</section>
<section class="slide level2">

<p>Rewriting slope equation to highlight what simple slope we want to graph. Just have to choose what we want to fix and what we want to vary</p>
<p><span class="math display">\[\hat{Y}_{ti} = [\gamma_{00}] + [\gamma_{10}   ]  * Time_{ti}\]</span> No random effects, because we wanted the expected value of the sample (or fixed effect) estimate graphed</p>
</section>
<section class="slide level2">

<p>Some packages do so much behind the scenes it is hard to know what is happening</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb41-2"><a href="#cb41-2"></a>p.mod4<span class="ot">&lt;-</span><span class="fu">ggpredict</span>(mod<span class="fl">.4</span>, <span class="st">"year.c"</span>)</span>
<span id="cb41-3"><a href="#cb41-3"></a>p.mod4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Predicted values of C

year.c | Predicted |       95% CI
---------------------------------
     0 |      4.75 | [4.74, 4.77]
     4 |      4.76 | [4.75, 4.77]
     8 |      4.77 | [4.75, 4.78]

Adjusted for:
* ID = 0 (population-level)</code></pre>
</div>
</div>
<p>Automatically chooses levels [0,4,8]</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">plot</span>(p.mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-36-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>If you want you can also get predicted lines for a particular individual. Along with prediction CI</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>p.r.mod2 <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(mod<span class="fl">.4</span>, <span class="st">"year.c"</span>, <span class="at">type =</span> <span class="st">"random"</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="at">Subject =</span> <span class="dv">97</span>))</span>
<span id="cb44-2"><a href="#cb44-2"></a>p.r.mod2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Predicted values of C

year.c | Predicted |       95% CI
---------------------------------
     0 |      4.75 | [3.68, 5.83]
     4 |      4.76 | [3.69, 5.84]
     8 |      4.77 | [3.69, 5.84]

Adjusted for:
* ID = 0 (population-level)</code></pre>
</div>
</div>
<p><span class="math display">\[\hat{Y}_{ti} = [\gamma_{00} + U_{0i}] + [\gamma_{10}+U_{1i} ]  * Time_{ti}\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">plot</span>(p.r.mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-38-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>p.r.mod3 <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(mod<span class="fl">.4</span>, <span class="fu">c</span>(<span class="st">"year.c"</span>,<span class="st">"ID[sample=9]"</span>), <span class="at">type =</span> <span class="st">"random"</span>)</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="fu">plot</span>(p.r.mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-39-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<ul>
<li><p>My preferred general approach is to use the {modelr} package. It is pretty user friendly, makes you aware of what is going on behind the scenes.</p></li>
<li><p>First we have to create a new dataframe for those values to go. If we are <em>not</em> going to use original data, then the fitted values cannot go into the original dataframe. So we need to make it up. To do so we are going to use the data_grid function from modelr. It is very similar to the expand.grid, crossing or other expand functions if you are familiar with those</p></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li><p>Right now our models are relatively simple, and all we have to do is feed in our time variable. But when we have multiple predictors and covariates that we may want at certain values, calculating the predicted values are relatively difficult by hand.</p></li>
<li><p>Think we want estimated trajectories at average levels of 4 background covariates, but only for females with college degrees, for example.</p></li>
<li><p>That is where modelr comes in (or marginaleffects).</p></li>
</ul>
</section>
<section class="slide level2">

<ol type="1">
<li>Start with a dataset that you created your model from and feed that to data_grid. Then we need to specify what variables you want to be constant and what variables you want to vary.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb48-2"><a href="#cb48-2"></a>b5_long <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3"></a>  <span class="fu">data_grid</span>(<span class="at">year.c =</span> <span class="fu">seq_range</span>(year.c, <span class="at">n =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 1
   year.c
    &lt;dbl&gt;
 1  0    
 2  0.889
 3  1.78 
 4  2.67 
 5  3.56 
 6  4.44 
 7  5.33 
 8  6.22 
 9  7.11 
10  8    </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>b5_long <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2"></a>  <span class="fu">data_grid</span>(<span class="at">year.c =</span> <span class="fu">seq_range</span>(year.c, <span class="at">n =</span> <span class="dv">10</span>), <span class="at">.model =</span> b5_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 49,680 × 10
   year.c  year   DOB   Sex     A     C     E     N     O ID     
    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  
 1      0  2009  1958     2  4.67  4.67     5  4.33  4.33 100001 
 2      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1000202
 3      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1000402
 4      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1000902
 5      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1003602
 6      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1003702
 7      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1003703
 8      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1004202
 9      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1006102
10      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1007602
# … with 49,670 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>b5_long <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2"></a>  <span class="fu">data_grid</span>(<span class="at">year.c =</span> <span class="fu">seq_range</span>(year.c, <span class="at">n =</span> <span class="dv">10</span>), <span class="at">.model =</span> b5_long) <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3"></a>    <span class="fu">add_predictions</span>(mod<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 49,680 × 11
   year.c  year   DOB   Sex     A     C     E     N     O ID       pred
    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
 1      0  2009  1958     2  4.67  4.67     5  4.33  4.33 100001   4.76
 2      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1000202  5.47
 3      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1000402  5.02
 4      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1000902  4.83
 5      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1003602  5.34
 6      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1003702  4.83
 7      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1003703  4.63
 8      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1004202  4.63
 9      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1006102  4.96
10      0  2009  1958     2  4.67  4.67     5  4.33  4.33 1007602  4.89
# … with 49,670 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>b5_long <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2"></a>  <span class="fu">data_grid</span>(<span class="at">year.c =</span> <span class="fu">seq_range</span>(year.c, <span class="at">n =</span> <span class="dv">10</span>), <span class="at">.model =</span> b5_long) <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3"></a>    <span class="fu">add_predictions</span>(mod<span class="fl">.4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred, <span class="at">x =</span> year.c, <span class="at">group =</span> ID)) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> .<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-43-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>fix_eff <span class="ot">&lt;-</span> b5_long <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2"></a>  <span class="fu">data_grid</span>(<span class="at">year.c =</span> <span class="fu">seq_range</span>(year.c, <span class="at">n =</span> <span class="dv">10</span>), <span class="at">.model =</span> b5_long) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3"></a>  <span class="fu">add_predictions</span>(mod<span class="fl">.4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-4"><a href="#cb55-4"></a>  <span class="fu">group_by</span>(year.c) <span class="sc">%&gt;%</span> </span>
<span id="cb55-5"><a href="#cb55-5"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">pred =</span> <span class="fu">mean</span>(pred)) </span>
<span id="cb55-6"><a href="#cb55-6"></a>fix_eff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   year.c  pred
    &lt;dbl&gt; &lt;dbl&gt;
 1  0      4.76
 2  0.889  4.76
 3  1.78   4.76
 4  2.67   4.76
 5  3.56   4.76
 6  4.44   4.76
 7  5.33   4.77
 8  6.22   4.77
 9  7.11   4.77
10  8      4.77</code></pre>
</div>
</div>
</section>
<section class="slide level2">


<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-45-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">


<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-46-1.png" width="960" class="r-stretch"></section>
<section id="adding-a-random-slope" class="slide level2">
<h2>Adding a random slope</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>b5_long<span class="ot">&lt;-</span> b5_long <span class="sc">%&gt;%</span>  </span>
<span id="cb57-2"><a href="#cb57-2"></a>  <span class="fu">mutate</span>(<span class="at">year.c =</span> (year <span class="sc">-</span> <span class="dv">2005</span>))</span>
<span id="cb57-3"><a href="#cb57-3"></a>  </span>
<span id="cb57-4"><a href="#cb57-4"></a>  </span>
<span id="cb57-5"><a href="#cb57-5"></a>mod<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> year.c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> year.c  <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span>
<span id="cb57-6"><a href="#cb57-6"></a></span>
<span id="cb57-7"><a href="#cb57-7"></a><span class="fu">summary</span>(mod<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: C ~ 1 + year.c + (1 + year.c | ID)
   Data: b5_long

REML criterion at convergence: 42714

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.0083 -0.4685  0.0461  0.4376  4.8649 

Random effects:
 Groups   Name        Variance  Std.Dev. Corr
 ID       (Intercept) 0.1050567 0.32412      
          year.c      0.0002853 0.01689  0.75
 Residual             0.2966451 0.54465      
Number of obs: 22081, groups:  ID, 8565

Fixed effects:
            Estimate Std. Error t value
(Intercept) 4.753235   0.006765  702.59
year.c      0.001783   0.001230    1.45

Correlation of Fixed Effects:
       (Intr)
year.c -0.591
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.00437407 (tol = 0.002, component 1)</code></pre>
</div>
</div>
</section>
<section class="slide level2">


<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-48-1.png" width="960" class="r-stretch"></section>
<section id="error-structure" class="slide level2">
<h2>Error Structure</h2>
<p>The residual structure, where the random effects are again normally distributed with a mean of zero, but this time one must also consider covariance in addition to variance.</p>
<p>G matrix (books term) <span class="math display">\[\begin{pmatrix} {U}_{0j} \\ {U}_{1j} \end{pmatrix}
\sim \mathcal{N} \begin{pmatrix}
  0,      \tau_{00}^{2} &amp; \tau_{01}\\
  0,  \tau_{01} &amp; \tau_{10}^{2}
\end{pmatrix}\]</span></p>
<p><span class="math display">\[{e}_{ij} \sim \mathcal{N}(0, \sigma^{2})\]</span> The <span class="math inline">\({e}_{ij}\)</span> is structured as a NxN matrix, where n reflect number of waves</p>
<p>Note that it is possible to impose a different error structure depending on your needs.</p>
</section>
<section id="decomposing-variance-for-random-intercept-model" class="slide level2">
<h2>Decomposing variance for random intercept model</h2>
<p><span class="math display">\[\text{Total variance CS} = \begin{pmatrix}
       \tau_{00}^{2} + \sigma^{2}&amp; \tau_{00}^{2} &amp; \tau_{00}^{2}\\
       \tau_{00}^{2} &amp;  \tau_{00}^{2} + \sigma^{2} &amp;  \tau_{00}^{2}\\
       \tau_{00}^{2} &amp; \tau_{00}^{2} &amp;   \tau_{00}^{2} + \sigma^{2}
\end{pmatrix}\]</span></p>
</section>
<section id="error-assumptions" class="slide level2">
<h2>Error assumptions</h2>
<p>Level 1 residuals are independent for Level 1 units across people<br>
AND</p>
<p>Level 1 residuals are independent of random effects</p>
<p>AND</p>
<p>Level 1 residuals are the same magnitude across people</p>
<p>We can modify a standard assumption: Level 1 residuals are independent within a person through different variance/covariance structures</p>
</section>
<section id="centering" class="slide level2">
<h2>centering</h2>
<p>Because mlms are regressions, and because mlms involve interactions, it is important to consider how your predictors zero point is defined.</p>
<p>How do you want your intercept interpreted? How do you want lower order terms in an interaction interpreted?</p>
<p>We will use these extensively to help disentangle within and between person variance.</p>
</section>
<section id="uncentered" class="slide level2">
<h2>Uncentered</h2>
<p>The default will give you predicted score of intercept when all predictors are zero.</p>
<p>Because most models will have a random intercept, it is important to keep in mind interpretations as we will be looking at variations around this value.</p>
</section>
<section id="grand-mean-centered" class="slide level2">
<h2>Grand mean Centered</h2>
<p>Zero now represents that grand mean of the sample. Calculated by taking <span class="math inline">\(x_{ti} - \bar{x}\)</span></p>
<p>Useful as this is often our the default in other methods. Changes meaning of intercept but not slope.</p>
<p>A related way to center is group grand mean centering where you take the mean of your grouping variables rather than the grand mean.</p>
</section>
<section id="group-mean-centering-person-centering" class="slide level2">
<h2>group mean centering (person centering)</h2>
<p>Calculated by taking <span class="math inline">\(x_{ti} - \bar{x_i}\)</span></p>
<p>Can change meaning of intercept and slope. Intercept is now a person’s average level rather than the samples average level (grand mean) and level when predictors = 0 (no centering)</p>
<p>Slope at level 1 is the expected change relative to a person’s average.</p>
</section>
<section id="as-starting" class="slide level2">
<h2>0 as starting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>b5_long<span class="ot">&lt;-</span> b5_long <span class="sc">%&gt;%</span>  </span>
<span id="cb59-2"><a href="#cb59-2"></a>  <span class="fu">mutate</span>(<span class="at">year.c =</span> (year <span class="sc">-</span> <span class="dv">2005</span>))</span>
<span id="cb59-3"><a href="#cb59-3"></a>  </span>
<span id="cb59-4"><a href="#cb59-4"></a>  </span>
<span id="cb59-5"><a href="#cb59-5"></a>mod<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> year.c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> year.c  <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span>
<span id="cb59-6"><a href="#cb59-6"></a></span>
<span id="cb59-7"><a href="#cb59-7"></a><span class="fu">summary</span>(mod<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: C ~ 1 + year.c + (1 + year.c | ID)
   Data: b5_long

REML criterion at convergence: 42714

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.0083 -0.4685  0.0461  0.4376  4.8649 

Random effects:
 Groups   Name        Variance  Std.Dev. Corr
 ID       (Intercept) 0.1050567 0.32412      
          year.c      0.0002853 0.01689  0.75
 Residual             0.2966451 0.54465      
Number of obs: 22081, groups:  ID, 8565

Fixed effects:
            Estimate Std. Error t value
(Intercept) 4.753235   0.006765  702.59
year.c      0.001783   0.001230    1.45

Correlation of Fixed Effects:
       (Intr)
year.c -0.591
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.00437407 (tol = 0.002, component 1)</code></pre>
</div>
</div>
</section>
<section id="as-mid" class="slide level2">
<h2>0 as mid</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>b5_long<span class="ot">&lt;-</span> b5_long <span class="sc">%&gt;%</span>  </span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="fu">mutate</span>(<span class="at">year.cM =</span> (year <span class="sc">-</span> <span class="dv">2009</span>))</span>
<span id="cb61-3"><a href="#cb61-3"></a>  </span>
<span id="cb61-4"><a href="#cb61-4"></a>  </span>
<span id="cb61-5"><a href="#cb61-5"></a>mod<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> year.cM <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> year.cM <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span>
<span id="cb61-6"><a href="#cb61-6"></a></span>
<span id="cb61-7"><a href="#cb61-7"></a><span class="fu">summary</span>(mod<span class="fl">.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: C ~ 1 + year.cM + (1 + year.cM | ID)
   Data: b5_long

REML criterion at convergence: 42714

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.0085 -0.4685  0.0461  0.4376  4.8649 

Random effects:
 Groups   Name        Variance  Std.Dev. Corr
 ID       (Intercept) 0.1426960 0.37775      
          year.cM     0.0002854 0.01689  0.83
 Residual             0.2966298 0.54464      
Number of obs: 22081, groups:  ID, 8565

Fixed effects:
            Estimate Std. Error t value
(Intercept) 4.760368   0.005535  860.07
year.cM     0.001783   0.001230    1.45

Correlation of Fixed Effects:
        (Intr)
year.cM 0.166 
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.00601838 (tol = 0.002, component 1)</code></pre>
</div>
</div>
</section>
<section id="estimation" class="slide level2">
<h2>Estimation</h2>
<p>We need to identify: 1. the estimates of each parameter 2. some measure of precision of that estimate (SEs) 3. an index of overall model fit (deviance/-2LL/aic/bic)</p>
<p>We will use maximum likelihood (and variants of) as well as MCMC (Bayesian) for estimation.</p>
<p>Model comparison is usually done through a likelihood ratio test distributed as a chi square.</p>
</section>
<section id="ml-vs-reml" class="slide level2">
<h2>ML vs REML</h2>
<p>REML = Restricted maximum likelihood</p>
<p>Similar to sample vs population estimates of SD where we do or don’t divide by n-1, ML downward biased random effect estimates.</p>
<p>REML maximizes the likelihood of the residuals, so models with different fixed effects are not on the same scale and are not comparable. As a result, you cannot compare fixed models with likleihood metrics (aic) with REML. You can compare variance differences.</p>
</section>
<section id="testing-significance" class="slide level2">
<h2>Testing significance</h2>
<p>Methods for testing single parameters From worst to best:</p>
<ol type="1">
<li>Wald Z-tests. Easy to compute. However, they are asymptotic approximations, assuming both that (1) the sampling distributions of the parameters are multivariate normal and that (2) the sampling distribution of the log-likelihood is (proportional to) χ2.</li>
<li>Wald t-tests</li>
<li>Likelihood ratio test.<br>
</li>
<li>Markov chain Monte Carlo (MCMC) or parametric bootstrap confidence intervals</li>
</ol>
</section>
<section id="likelhiood-ratio-test" class="slide level2">
<h2>Likelhiood ratio test</h2>
<p>How much more likely the data is under a more complex model than under the simpler model (these models need to be nested to compare this).</p>
<p>Log Likelihood (LL) is derived from ML estimation. Larger the LL the better the fit. Deviance compares two LLs. Current model and a saturated model (that fits data perfectly).</p>
<p>Deviance = -2[LL current - LL saturated]</p>
<p>LL saturated = 1 for MLMs (probability it will perfectly recapture data). log of 1 is 0. So this term drops out.</p>
<p>Deviance = -2LL current model.</p>
</section>
<section id="likelhiood-ratio-test-1" class="slide level2">
<h2>Likelhiood ratio test</h2>
<p>Comparing 2 models is called a likelihood ration test. Need to have: 1. same data 2. nested models (think of constraining a parameter to zero)</p>
<p>Distributed as chi-square with df equal to constraint differences between models.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Data: b5_long
Models:
mod.1: C ~ 1 + (1 | ID)
mod.2: C ~ 1 + year + (1 | ID)
      npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
mod.1    3 42778 42802 -21386    42772                     
mod.2    5 42780 42820 -21385    42770 2.4256  2     0.2974</code></pre>
</div>
</div>
<p>What does this look like pictorially?</p>
</section>
<section id="random-slope" class="slide level2">
<h2>random slope</h2>
<p>Level 1: <span class="math display">\[{Y}_{it} = \beta_{0i}  + \beta_{1i}X_{ti} + \varepsilon_{ti}\]</span></p>
<p>Level 2:<br>
<span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span><br>
</p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} + U_{1i}\]</span></p>
<p>Combined: <span class="math display">\[{Y}_{ti} = \gamma_{00} + \gamma_{10} (X_{1i})+ U_{0i}  + U_{1i}(X_{1i}) + \varepsilon_{ti}\]</span></p>
</section>
<section id="correlations-among-random-effects" class="slide level2">
<h2>correlations among random effects</h2>
<p><span class="math display">\[\begin{pmatrix} {U}_{0i} \\ {U}_{1i} \end{pmatrix} \sim \mathcal{N} \begin{pmatrix} 0, &amp; \tau_{00}^{2} &amp; \tau_{01}\\ 0, &amp; \tau_{01} &amp; \tau_{10}^{2} \end{pmatrix}\]</span></p>
<p>The variances and the covariation (correlations) can be of substantive interest. What do each of these terms reflect? What if one of the terms was zero, what would that mean?</p>
</section>
<section id="residual" class="slide level2">
<h2>residual</h2>
<p><span class="math display">\[ {\varepsilon}_{ti} \sim \mathcal{N}(0, \sigma^{2})  \]</span> Much like in normal regression models we often use <span class="math inline">\(\sigma^{2}\)</span> as a means to describe the fit of the model</p>
</section>
<section class="slide level2">


<img data-src="5.3.png" class="r-stretch"></section>
<section id="model-comparisons" class="slide level2">
<h2>model comparisons</h2>
<p>In setting up the basic growth model we have a series of questions to address:</p>
<ol type="1">
<li>Do we need to add a time component?</li>
<li>If so, do we need to allow that to vary across people?</li>
<li>if so, do we want to allow the intercept to correlate with the slope?</li>
</ol>
<p>Usually 1 &amp; 2 are explicitly tested whereas 3 is more theoretical</p>
</section>
<section class="slide level2">


<img data-src="5.1.png" class="r-stretch"></section>
<section id="centering-redux" class="slide level2">
<h2>centering redux</h2>
<p>The correlation among random intercept and slopes is directly related to centering of variables. The two standard choices for time is to center at the mean of time or at the start of time. Both have their pros and cons.</p>

<img data-src="5.4.png" width="550" class="r-stretch"></section>
<section id="other-types-of-models" class="slide level2">
<h2>Other types of models</h2>
<p>Depending on your DV, you might not want to have a Gaussian sampling distribution. Instead you may want something like a Poisson or a negative binomial if you are using some sort of count data. You can do this somewhat with lme4. However, the BRMS package – which uses Bayesian estimation – has many more possibilities: geometric, log normal, weibull, exponential, gamma, Beta, hurdle Poisson/gamma/negative binomial, zero inflated beta/Poisson/negative binomial, cumulative. Maybe we will fit some of these later in the semester.</p>

<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          let href = ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>