<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.0.37">

  <title>ALDA2022 - conditional</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">conditional</h1>
</section>

<section id="conditional-models" class="slide level2">
<h2>Conditional models</h2>
<ul>
<li><p>We are now going to introduce predictors to our growth models beyond time. These predictors are similar to predictors in standard regression – dummy for nominal, interactions change lower order terms, etcetera.</p></li>
<li><p>This is all just regression, so the same interpretation is the same. It is now only harder because we have multiple levels and lots of potential for interactions</p></li>
</ul>
</section>
<section id="level-2-group-predictors" class="slide level2">
<h2>Level 2 group predictors</h2>
<ul>
<li>Do groups differ in their initial status? Level 2, person variable that is dummy coded. Note that group here only is measured once, it is a between person variable.</li>
</ul>
<p>level 1: <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}G_{i} +   U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} + U_{1i}\]</span></p>
</section>
<section id="interpretation-of-conditional-fixed-effects" class="slide level2">
<h2>Interpretation of conditional fixed effects</h2>
<p>Notice we have a new gamma term, <span class="math inline">\(\gamma_{01}\)</span>. How do we interpret this new fixed effect, especially in the presence of other fixed effects?</p>
<p><span class="math inline">\(\gamma_{00}\)</span> is the intercept and can be considered the value when G = 0 and time = 0, whereas the <span class="math inline">\(\gamma_{01}\)</span> is the difference in initial values between groups.</p>
<p>The value for group = 1? <span class="math inline">\(\gamma_{00} + \gamma_{01}\)</span></p>
</section>
<section class="slide level2">

<p>Combined: <span class="math display">\[{Y}_{ti} = \gamma_{00} + \gamma_{01}G_{i} + \gamma_{10} (Time_{ti})+ U_{0i}  + U_{1i}(Time_{ti}) + \varepsilon_{ti}\]</span> <span class="math display">\[{Y}_{ti} = (\gamma_{00} + \gamma_{01}G_{i} + U_{0i} ) + [(\gamma_{10}+ U_{1i})(Time_{ti})] + \varepsilon_{ti}\]</span></p>
</section>
<section id="interpretation-of-random-effects" class="slide level2">
<h2>Interpretation of random effects</h2>
<ul>
<li>One thing to keep in mind is that we are now changing the meaning of the random effect. Now that we have a predictor in the model, the <span class="math inline">\(U_{0j}\)</span> is the person specific deviation from the group predicted intercept, not the grand mean intercept.</li>
</ul>
<p>Level 1:<br>
</p>
<p><span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}G_{i} +   U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} + U_{1i}\]</span></p>
</section>
<section id="does-your-covariance-structure-change" class="slide level2">
<h2>Does your covariance structure change?</h2>
<p>Level 2 covariance matrix <span class="math display">\[\begin{pmatrix} {U}_{0j} \\ {U}_{1j} \end{pmatrix}
\sim \mathcal{N} \begin{pmatrix}
  0,     &amp; \tau_{00}^{2} &amp; \tau_{01}\\
  0, &amp; \tau_{01} &amp; \tau_{10}^{2}
\end{pmatrix}\]</span></p>
<p>Level 1 residual variance will also be different</p>
<p><span class="math display">\[ {R}_{ij} \sim \mathcal{N}(0, \sigma^{2})  \]</span></p>
</section>
<section id="equations-for-each-group" class="slide level2">
<h2>Equations for each group</h2>
<p><span class="math display">\[{Y}_{ti} = (\gamma_{00} + \gamma_{01}G_{i} + U_{0i} ) + [(\gamma_{10}+ U_{1i})(Time_{ti})] + \varepsilon_{ti}\]</span></p>
<p>Understanding how to re-write the equation will help for calculating estimated scores for your predictors in addition to being able to interpret the coefficients.</p>
<p>Estimated value for an individual in group = 0<br>
</p>
<p><span class="math display">\[\hat{Y}_{ti} = (\gamma_{00} + U_{0i} ) + [(\gamma_{10}+ U_{1i})(Time_{ti})]\]</span> group = 1 individual <span class="math display">\[\hat{Y}_{ti} = (\gamma_{00} + \gamma_{01}+ U_{0i} ) + [(\gamma_{10}+ U_{1i})(Time_{ti})]\]</span></p>
</section>
<section class="slide level2">

<p>We can also create group mean estimated trajectories</p>
<p><span class="math display">\[{Y}_{ti} = (\gamma_{00} + \gamma_{01}G_{i} + U_{0i} ) + [(\gamma_{10}+ U_{1i})(Time_{ti})] + \varepsilon_{ti}\]</span></p>
<p>group = 0 trajectory <span class="math display">\[\hat{Y}_{ti} = (\gamma_{00}) + (\gamma_{10})(Time_{ti})\]</span></p>
<p>group = 1 trajectory <span class="math display">\[\hat{Y}_{ti} = (\gamma_{00}+ \gamma_{01}) + (\gamma_{10})(Time_{ti})\]</span></p>
</section>
<section id="slope-and-intercept-group-predictors" class="slide level2">
<h2>Slope and Intercept Group Predictors</h2>
<p>Predicting the intercept only can only answer static questions, not about change.</p>
<p>Level 1:<br>
</p>
<p><span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}G_{i} +   U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  \gamma_{11}G_{i} +U_{1i}\]</span></p>
<p>Similar to before, the interpretation of <span class="math inline">\(U_{1i}\)</span> changes. The term is now what is left over after accounting for group differences in the mean slope.</p>
</section>
<section id="cross-level-interactions" class="slide level2">
<h2>cross level interactions</h2>
<p>Level 1:<br>
</p>
<p><span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}G_{i} +   U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  \gamma_{11}G_{i} +U_{1i}\]</span></p>
<p>Combined: <span class="math display">\[{Y}_{ti} = \gamma_{00} + \gamma_{01}G_{i}+  \gamma_{10} (Time_{ti}) + \gamma_{11}(G_{i}*Time_{ti}) + \]</span> <span class="math display">\[ U_{0i} + U_{1i}(Time_{ti}) + \varepsilon_{ti}\]</span></p>
</section>
<section class="slide level2">

<p>Notice that when we combine Level 1 and Level 2, the slope effect predictor becomes an interaction with time. Anytime you have a predictor of time that will be an interaction with time in that we are asking does group status (or what ever variable) differs in their relationship between time and your DV.</p>
</section>
<section id="interpretation-of-lower-order-terms" class="slide level2">
<h2>interpretation of lower order terms</h2>
<p>Combined: <span class="math display">\[{Y}_{ti} = \gamma_{00} + \gamma_{01}G_{i}+  \gamma_{10} (Time_{ti}) + \gamma_{11}(G_{i}*Time_{ti}) + \]</span> <span class="math display">\[ U_{0i} + U_{1i}(Time_{ti}) + \varepsilon_{ti}\]</span></p>
<p>As with regression, the lower order terms are now conditional on the higher order interaction.</p>
<p><span class="math inline">\(\gamma_{10}\)</span>, the fixed effect representing our slope is now the simple slope for group = 0</p>
<p><span class="math inline">\(\gamma_{01}\)</span>, the fixed effect for group is the difference between groups when time = 0, e.g.&nbsp;the intercept</p>
<p><span class="math inline">\(\gamma_{00}\)</span> is the intercept, it is the value for when our predictors are zero.</p>
</section>
<section id="residual-structure" class="slide level2">
<h2>residual structure</h2>
<p>Level 2 covariance matrix</p>
<p><span class="math display">\[\begin{pmatrix} {U}_{0j} \\ {U}_{1j} \end{pmatrix} \sim\mathcal{N} \begin{pmatrix} 0, \tau_{00}^{2} &amp; \tau_{01}\\  0,  \tau_{01} &amp; \tau_{10}^{2} \end{pmatrix}\]</span></p>
<p>How does your variance-covariance matrix change?</p>
<p>Level 1 residual variance <span class="math display">\[{R}_{ij} \sim \mathcal{N}(0, \sigma^{2})\]</span></p>
<p>How does your residual change relative to a model without group effects? Can you graph conceptually what this now captures?</p>
</section>
<section id="predictive-equation" class="slide level2">
<h2>predictive equation</h2>
<p>Thinking about the equation as a predictive engine will help us later with graphing</p>
<p>Alternative combined <span class="math display">\[{Y}_{ti} = [\gamma_{00} + U_{0i} +\gamma_{01}G_{i}] + [(\gamma_{10}  + \gamma_{11}G_{i}+  U_{1i})(Time_{ti})] + \varepsilon_{ti}\]</span></p>
<p>This is just rearranged so you can see that different groups have different intercepts and slopes</p>
<p><span class="math display">\[\hat{Y}_{ti} = [\gamma_{00} +\gamma_{01}G_{i}] + [(\gamma_{10}  + \gamma_{11}G_{i})(Time_{ti})]\]</span></p>
<p>Notice how when G = 0, the equation simplifies:</p>
<p><span class="math display">\[\hat{Y}_{ti} = \gamma_{00} + \gamma_{10} (Time_{ti})\]</span></p>
</section>
<section id="plotting" class="slide level2">
<h2>Plotting</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a>alcohol <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/longitudinal-2022/main/alcohol1_pp.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">head</span>(alcohol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  X id age coa male age_14   alcuse      peer      cpeer  ccoa
1 1  1  14   1    0      0 1.732051 1.2649111  0.2469111 0.549
2 2  1  15   1    0      1 2.000000 1.2649111  0.2469111 0.549
3 3  1  16   1    0      2 2.000000 1.2649111  0.2469111 0.549
4 4  2  14   1    1      0 0.000000 0.8944272 -0.1235728 0.549
5 5  2  15   1    1      1 0.000000 0.8944272 -0.1235728 0.549
6 6  2  16   1    1      2 1.000000 0.8944272 -0.1235728 0.549</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb3-2"><a href="#cb3-2"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(alcuse <span class="sc">~</span>  age_14 <span class="sc">+</span> (age_14 <span class="sc">|</span> id), <span class="at">data =</span> alcohol)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: alcuse ~ age_14 + (age_14 | id)
   Data: alcohol

REML criterion at convergence: 643.2

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.48287 -0.37933 -0.07858  0.38876  2.49284 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 id       (Intercept) 0.6355   0.7972        
          age_14      0.1552   0.3939   -0.23
 Residual             0.3373   0.5808        
Number of obs: 246, groups:  id, 82

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.65130    0.10573   6.160
age_14       0.27065    0.06284   4.307

Correlation of Fixed Effects:
       (Intr)
age_14 -0.441</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(alcuse <span class="sc">~</span>  age_14 <span class="sc">+</span> male <span class="sc">+</span>  (age_14 <span class="sc">|</span> id), <span class="at">data =</span> alcohol)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: alcuse ~ age_14 + male + (age_14 | id)
   Data: alcohol

REML criterion at convergence: 644.6

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.48295 -0.38330 -0.07969  0.38766  2.49001 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 id       (Intercept) 0.6482   0.8051        
          age_14      0.1552   0.3939   -0.23
 Residual             0.3373   0.5808        
Number of obs: 246, groups:  id, 82

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.63375    0.14459   4.383
age_14       0.27065    0.06284   4.307
male         0.03427    0.19103   0.179

Correlation of Fixed Effects:
       (Intr) age_14
age_14 -0.326       
male   -0.677  0.000</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(alcuse <span class="sc">~</span>  age_14 <span class="sc">*</span> male <span class="sc">+</span> (age_14 <span class="sc">|</span> id), <span class="at">data =</span> alcohol)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">summary</span>(fit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: alcuse ~ age_14 * male + (age_14 | id)
   Data: alcohol

REML criterion at convergence: 641.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.4830 -0.4562 -0.1830  0.3548  2.3953 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 id       (Intercept) 0.6383   0.7989        
          age_14      0.1374   0.3707   -0.20
 Residual             0.3373   0.5808        
Number of obs: 246, groups:  id, 82

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.74562    0.15161   4.918
age_14       0.12129    0.08747   1.387
male        -0.18415    0.21184  -0.869
age_14:male  0.29161    0.12223   2.386

Correlation of Fixed Effects:
            (Intr) age_14 male  
age_14      -0.432              
male        -0.716  0.309       
age_14:male  0.309 -0.716 -0.432</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">library</span>(easystats)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">model_parameters</span>(fit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter     | Coefficient |   SE |        95% CI | t(238) |      p
--------------------------------------------------------------------
(Intercept)   |        0.75 | 0.15 | [ 0.45, 1.04] |   4.92 | &lt; .001
age 14        |        0.12 | 0.09 | [-0.05, 0.29] |   1.39 | 0.167 
male          |       -0.18 | 0.21 | [-0.60, 0.23] |  -0.87 | 0.386 
age 14 * male |        0.29 | 0.12 | [ 0.05, 0.53] |   2.39 | 0.018 

# Random Effects

Parameter                  | Coefficient
----------------------------------------
SD (Intercept: id)         |        0.80
SD (age_14: id)            |        0.37
Cor (Intercept~age_14: id) |       -0.20
SD (Residual)              |        0.58</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb11-2"><a href="#cb11-2"></a>alcohol <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">data_grid</span>(<span class="at">age_14 =</span> <span class="fu">seq_range</span>(age_14, <span class="at">n =</span> <span class="dv">5</span>), male, <span class="at">.model =</span> alcohol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 9
   age_14  male    id   age   coa alcuse  peer  cpeer   ccoa
    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1    0       0    41    15     0      1 0.894 -0.124 -0.451
 2    0       1    41    15     0      1 0.894 -0.124 -0.451
 3    0.5     0    41    15     0      1 0.894 -0.124 -0.451
 4    0.5     1    41    15     0      1 0.894 -0.124 -0.451
 5    1       0    41    15     0      1 0.894 -0.124 -0.451
 6    1       1    41    15     0      1 0.894 -0.124 -0.451
 7    1.5     0    41    15     0      1 0.894 -0.124 -0.451
 8    1.5     1    41    15     0      1 0.894 -0.124 -0.451
 9    2       0    41    15     0      1 0.894 -0.124 -0.451
10    2       1    41    15     0      1 0.894 -0.124 -0.451</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>alcohol <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">data_grid</span>(<span class="at">age_14 =</span> <span class="fu">seq_range</span>(age_14, <span class="at">n =</span> <span class="dv">5</span>), male, <span class="at">.model =</span> alcohol) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="fu">add_predictions</span>(fit3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 10
   age_14  male    id   age   coa alcuse  peer  cpeer   ccoa  pred
    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1    0       0    41    15     0      1 0.894 -0.124 -0.451 0.893
 2    0       1    41    15     0      1 0.894 -0.124 -0.451 0.708
 3    0.5     0    41    15     0      1 0.894 -0.124 -0.451 0.998
 4    0.5     1    41    15     0      1 0.894 -0.124 -0.451 0.960
 5    1       0    41    15     0      1 0.894 -0.124 -0.451 1.10 
 6    1       1    41    15     0      1 0.894 -0.124 -0.451 1.21 
 7    1.5     0    41    15     0      1 0.894 -0.124 -0.451 1.21 
 8    1.5     1    41    15     0      1 0.894 -0.124 -0.451 1.46 
 9    2       0    41    15     0      1 0.894 -0.124 -0.451 1.32 
10    2       1    41    15     0      1 0.894 -0.124 -0.451 1.71 </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>alcohol <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">data_grid</span>(<span class="at">age_14 =</span> <span class="fu">seq_range</span>(age_14, <span class="at">n =</span> <span class="dv">5</span>), male, <span class="at">.model =</span> alcohol) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3"></a>    <span class="fu">add_predictions</span>(fit3) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred, <span class="at">x =</span> age_14, <span class="at">group =</span> male)) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section id="l2-continuous-predictors" class="slide level2">
<h2>L2 Continuous predictors</h2>
<p>A continuous L2 predictor is similar to the group predictors.</p>
<p>Level 1:<br>
</p>
<p><span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}C_{i} +   U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  \gamma_{11}C_{i} +U_{1i}\]</span></p>
<p>Combined: <span class="math display">\[{Y}_{ti} = \gamma_{00} + \gamma_{01}C_{i}+  \gamma_{10} (Time_{ti}) + \gamma_{11}(C_{i}*Time_{ti}) +  \]</span> <span class="math display">\[ U_{0i} + U_{1j}(Time_{ti}) + \varepsilon_{ti}\]</span></p>
</section>
<section id="continuous-conditional-interpretation" class="slide level2">
<h2>Continuous conditional interpretation</h2>
<p><span class="math display">\[{Y}_{ti} = \gamma_{00} + \gamma_{01}C_{i}+  \gamma_{10} (Time_{ti}) + \gamma_{11}(C_{i}*Time_{ti}) +  \]</span> <span class="math display">\[ U_{0i} + U_{1j}(Time_{ti}) + \varepsilon_{ti}\]</span></p>
<p>The <span class="math inline">\(\gamma_{11}\)</span> interaction coefficient indexes the difference in slopes at different levels of C</p>
<p>The <span class="math inline">\(\gamma_{10}\)</span> is now the effect of time when the continuous predictor is zero.</p>
<p>The <span class="math inline">\(\gamma_{01}\)</span> is now the effect of C when time is zero.</p>
<p><span class="math inline">\(\gamma_{00}\)</span> is the intercept, it is the value for when our predictors are zero.</p>
<p><span class="math inline">\(U_{0i}\)</span> Is the random effect for intercept after accounting for C.</p>
<p><span class="math inline">\(U_{1i}\)</span> Is the random effect for the slope after accounting for C.</p>
</section>
<section id="equations-for-plotting" class="slide level2">
<h2>Equations for plotting</h2>
<p>The same logic for plotting continuous variables except this time we have to choose the values for simple slopes</p>
<p><span class="math display">\[\hat{Y}_{ti} = [\gamma_{00} + \gamma_{01}C_{i}]+  [\gamma_{10} + \gamma_{11}C_{i}]*Time_{ti}\]</span></p>
<p>Assuming C is standardized: -1sd <span class="math display">\[\hat{Y}_{ti} = [\gamma_{00} +(\gamma_{01}*-1)] + [\gamma_{10}  + (\gamma_{11}*-1)]*Time_{ti}\]</span></p>
<p>Mean <span class="math display">\[\hat{Y}_{ti} = \gamma_{00} + \gamma_{10} * (Time_{ti})\]</span></p>
<p>+1sd <span class="math display">\[\hat{Y}_{ti} = [\gamma_{00} +\gamma_{01}] + [\gamma_{10}  + \gamma_{11}]*Time_{ti}\]</span></p>
</section>
<section id="individual-level-trajectories" class="slide level2">
<h2>individual level trajectories</h2>
<p>What do individual level trajectories look like?</p>
<p><span class="math display">\[\hat{Y}_{ti} = [\gamma_{00} + \gamma_{01}C_{i}+  U_{0i}] + \]</span> <span class="math display">\[ [\gamma_{10}  + (\gamma_{11}*C_{i}) + U_{1i}]  * Time_{ti}\]</span></p>
<p>If you know someones random effects, and you know the fixed effects, you can create predicted values for any level of time.</p>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(alcuse <span class="sc">~</span>  age_14 <span class="sc">+</span> peer <span class="sc">+</span> (age_14 <span class="sc">|</span> id), <span class="at">data =</span> alcohol)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">summary</span>(fit4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: alcuse ~ age_14 + peer + (age_14 | id)
   Data: alcohol

REML criterion at convergence: 615.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.5192 -0.3643 -0.1291  0.4198  2.4918 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 id       (Intercept) 0.3396   0.5827        
          age_14      0.1552   0.3939   -0.08
 Residual             0.3373   0.5808        
Number of obs: 246, groups:  id, 82

Fixed effects:
            Estimate Std. Error t value
(Intercept) -0.03236    0.14113  -0.229
age_14       0.27065    0.06284   4.307
peer         0.67186    0.10920   6.152

Correlation of Fixed Effects:
       (Intr) age_14
age_14 -0.256       
peer   -0.787  0.000</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>fit5 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(alcuse <span class="sc">~</span>  age_14 <span class="sc">+</span> cpeer <span class="sc">+</span> (age_14 <span class="sc">|</span> id), <span class="at">data =</span> alcohol)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">summary</span>(fit5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: alcuse ~ age_14 + cpeer + (age_14 | id)
   Data: alcohol

REML criterion at convergence: 615.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.5192 -0.3643 -0.1291  0.4198  2.4918 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 id       (Intercept) 0.3396   0.5827        
          age_14      0.1552   0.3939   -0.08
 Residual             0.3373   0.5808        
Number of obs: 246, groups:  id, 82

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.65160    0.08700   7.490
age_14       0.27065    0.06284   4.307
cpeer        0.67186    0.10920   6.152

Correlation of Fixed Effects:
       (Intr) age_14
age_14 -0.415       
cpeer   0.001  0.000</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>fit6 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(alcuse <span class="sc">~</span>  age_14 <span class="sc">*</span> cpeer <span class="sc">+</span> (age_14 <span class="sc">|</span> id), <span class="at">data =</span> alcohol)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="fu">summary</span>(fit6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: alcuse ~ age_14 * cpeer + (age_14 | id)
   Data: alcohol

REML criterion at convergence: 615.4

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.51919 -0.40761 -0.07863  0.39879  2.40565 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 id       (Intercept) 0.3369   0.5804        
          age_14      0.1469   0.3832   -0.06
 Residual             0.3373   0.5808        
Number of obs: 246, groups:  id, 82

Fixed effects:
             Estimate Std. Error t value
(Intercept)   0.65164    0.08681   7.507
age_14        0.27058    0.06203   4.362
cpeer         0.75877    0.11974   6.337
age_14:cpeer -0.15138    0.08556  -1.769

Correlation of Fixed Effects:
            (Intr) age_14 cpeer 
age_14      -0.410              
cpeer        0.001  0.000       
age_14:cper  0.000  0.001 -0.410</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">model_parameters</span>(fit6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter      | Coefficient |   SE |        95% CI | t(238) |      p
---------------------------------------------------------------------
(Intercept)    |        0.65 | 0.09 | [ 0.48, 0.82] |   7.51 | &lt; .001
age 14         |        0.27 | 0.06 | [ 0.15, 0.39] |   4.36 | &lt; .001
cpeer          |        0.76 | 0.12 | [ 0.52, 0.99] |   6.34 | &lt; .001
age 14 * cpeer |       -0.15 | 0.09 | [-0.32, 0.02] |  -1.77 | 0.078 

# Random Effects

Parameter                  | Coefficient
----------------------------------------
SD (Intercept: id)         |        0.58
SD (age_14: id)            |        0.38
Cor (Intercept~age_14: id) |       -0.06
SD (Residual)              |        0.58</code></pre>
</div>
</div>
</section>
<section id="plotting-1" class="slide level2">
<h2>Plotting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">library</span>(report)</span>
<span id="cb24-2"><a href="#cb24-2"></a>alcohol <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3"></a>   <span class="fu">report_sample</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Descriptive Statistics

Variable         |        Summary
---------------------------------
Mean X (SD)      | 123.50 (71.16)
Mean id (SD)     |  41.50 (23.72)
Mean age (SD)    |   15.00 (0.82)
Mean coa (SD)    |    0.45 (0.50)
Mean male (SD)   |    0.51 (0.50)
Mean age_14 (SD) |    1.00 (0.82)
Mean alcuse (SD) |    0.92 (1.06)
Mean peer (SD)   |    1.02 (0.73)
Mean cpeer (SD)  |   -0.00 (0.73)
Mean ccoa (SD)   |    0.00 (0.50)</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>alcohol <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">data_grid</span>(<span class="at">age_14 =</span> <span class="fu">seq_range</span>(age_14, <span class="at">n =</span> <span class="dv">5</span>), <span class="at">cpeer =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">73</span>,<span class="dv">0</span>,.<span class="dv">73</span>), <span class="at">.model =</span> alcohol) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3"></a>    <span class="fu">add_predictions</span>(fit6) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 10
   age_14 cpeer    id   age   coa  male alcuse  peer   ccoa     pred
    &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1    0   -0.73    41    15     0     1      1 0.894 -0.451 -0.00290
 2    0    0       41    15     0     1      1 0.894 -0.451  0.551  
 3    0    0.73    41    15     0     1      1 0.894 -0.451  1.10   
 4    0.5 -0.73    41    15     0     1      1 0.894 -0.451  0.201  
 5    0.5  0       41    15     0     1      1 0.894 -0.451  0.700  
 6    0.5  0.73    41    15     0     1      1 0.894 -0.451  1.20   
 7    1   -0.73    41    15     0     1      1 0.894 -0.451  0.405  
 8    1    0       41    15     0     1      1 0.894 -0.451  0.848  
 9    1    0.73    41    15     0     1      1 0.894 -0.451  1.29   
10    1.5 -0.73    41    15     0     1      1 0.894 -0.451  0.609  
11    1.5  0       41    15     0     1      1 0.894 -0.451  0.997  
12    1.5  0.73    41    15     0     1      1 0.894 -0.451  1.39   
13    2   -0.73    41    15     0     1      1 0.894 -0.451  0.813  
14    2    0       41    15     0     1      1 0.894 -0.451  1.15   
15    2    0.73    41    15     0     1      1 0.894 -0.451  1.48   </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>alcohol <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">data_grid</span>(<span class="at">age_14 =</span> <span class="fu">seq_range</span>(age_14, <span class="at">n =</span> <span class="dv">5</span>), <span class="at">cpeer =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">73</span>,<span class="dv">0</span>,.<span class="dv">73</span>), <span class="at">.model =</span> alcohol) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3"></a>    <span class="fu">add_predictions</span>(fit6) <span class="sc">%&gt;%</span> </span>
<span id="cb28-4"><a href="#cb28-4"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred, <span class="at">x =</span> age_14, <span class="at">group =</span> cpeer)) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section id="multiple-predictors" class="slide level2">
<h2>Multiple predictors</h2>
<p>Interpretations with multiple predictors in regression extend to MLMs. For example, health across time, examining the effects of an intervention, while controlling for initial exercise status?:</p>
<p>level 1: <span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \varepsilon_{ti}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}Exercise_{i} +  \gamma_{02}Intervention_{i} +   U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} + \gamma_{11}Intervention_{i} + U_{1i}\]</span></p>
</section>
<section id="sem" class="slide level2">
<h2>SEM</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>alcohol.wide <span class="ot">&lt;-</span> alcohol <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>X, <span class="sc">-</span>age_14, <span class="sc">-</span>ccoa) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"age"</span>, </span>
<span id="cb29-4"><a href="#cb29-4"></a>              <span class="at">names_prefix =</span> <span class="st">"alcuse_"</span>,</span>
<span id="cb29-5"><a href="#cb29-5"></a>              <span class="at">values_from  =</span> alcuse) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sem-covariatespredictors" class="slide level2">
<h2>SEM covariates/predictors</h2>
<p>The strategy for including predictors is similar to working with a level 2 mlm equation. Do you want to predict the intercept or the slope? No need to explicitly model an interaction as that is implied.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb30-2"><a href="#cb30-2"></a>sem<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="st">'  i =~ 1*alcuse_14 + 1*alcuse_15 + 1*alcuse_16 </span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="st">            s =~ 0*alcuse_14 + 1*alcuse_15 + 2*alcuse_16</span></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="st">               </span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="st"># regressions</span></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="st">    </span></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="st">    i ~ male </span></span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="st">    s ~ male</span></span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="st">'</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>fit<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">growth</span>(sem<span class="fl">.1</span>, <span class="at">data =</span> alcohol.wide)</span>
<span id="cb30-11"><a href="#cb30-11"></a><span class="fu">summary</span>(fit<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-11 ended normally after 27 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        10
                                                      
  Number of observations                            82
                                                      
Model Test User Model:
                                                      
  Test statistic                                 4.213
  Degrees of freedom                                 2
  P-value (Chi-square)                           0.122

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    alcuse_14         1.000                           
    alcuse_15         1.000                           
    alcuse_16         1.000                           
  s =~                                                
    alcuse_14         0.000                           
    alcuse_15         1.000                           
    alcuse_16         2.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~                                                 
    male             -0.110    0.206   -0.534    0.594
  s ~                                                 
    male              0.272    0.120    2.261    0.024

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
 .i ~~                                                
   .s                -0.173    0.098   -1.762    0.078

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .alcuse_14         0.000                           
   .alcuse_15         0.000                           
   .alcuse_16         0.000                           
   .i                 0.692    0.147    4.701    0.000
   .s                 0.136    0.086    1.575    0.115

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .alcuse_14         0.080    0.147    0.546    0.585
   .alcuse_15         0.432    0.095    4.537    0.000
   .alcuse_16         0.216    0.175    1.236    0.216
   .i                 0.789    0.191    4.127    0.000
   .s                 0.225    0.082    2.749    0.006</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb32-2"><a href="#cb32-2"></a>sem<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="st">'  i =~ 1*alcuse_14 + 1*alcuse_15 + 1*alcuse_16 </span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="st">            s =~ 0*alcuse_14 + 1*alcuse_15 + 2*alcuse_16</span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="st">               </span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="st"># regressions</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="st">    </span></span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="st">    i ~ peer </span></span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="st">    s ~ peer</span></span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="st">'</span></span>
<span id="cb32-10"><a href="#cb32-10"></a>fit<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">growth</span>(sem<span class="fl">.2</span>, <span class="at">data =</span> alcohol.wide)</span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="fu">summary</span>(fit<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-11 ended normally after 24 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        10
                                                      
  Number of observations                            82
                                                      
Model Test User Model:
                                                      
  Test statistic                                 2.406
  Degrees of freedom                                 2
  P-value (Chi-square)                           0.300

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    alcuse_14         1.000                           
    alcuse_15         1.000                           
    alcuse_16         1.000                           
  s =~                                                
    alcuse_14         0.000                           
    alcuse_15         1.000                           
    alcuse_16         2.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~                                                 
    peer              0.736    0.117    6.288    0.000
  s ~                                                 
    peer             -0.139    0.084   -1.656    0.098

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
 .i ~~                                                
   .s                -0.075    0.082   -0.912    0.362

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .alcuse_14         0.000                           
   .alcuse_15         0.000                           
   .alcuse_16         0.000                           
   .i                -0.108    0.146   -0.735    0.462
   .s                 0.418    0.105    3.978    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .alcuse_14         0.175    0.124    1.416    0.157
   .alcuse_15         0.375    0.083    4.529    0.000
   .alcuse_16         0.349    0.175    1.990    0.047
   .i                 0.430    0.138    3.114    0.002
   .s                 0.177    0.076    2.312    0.021</code></pre>
</div>
</div>
</section>
<section id="centered-predictors" class="slide level2">
<h2>centered predictors</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>sem<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="st">'  i =~ 1*alcuse_14 + 1*alcuse_15 + 1*alcuse_16 </span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="st">            s =~ 0*alcuse_14 + 1*alcuse_15 + 2*alcuse_16</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="st">               </span></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="st"># regressions</span></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="st">    </span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="st">    i ~ cpeer</span></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="st">    s ~  cpeer</span></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="st">'</span></span>
<span id="cb34-9"><a href="#cb34-9"></a>fit<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">growth</span>(sem<span class="fl">.3</span>, <span class="at">data =</span> alcohol.wide)</span>
<span id="cb34-10"><a href="#cb34-10"></a><span class="fu">summary</span>(fit<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-11 ended normally after 24 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        10
                                                      
  Number of observations                            82
                                                      
Model Test User Model:
                                                      
  Test statistic                                 2.406
  Degrees of freedom                                 2
  P-value (Chi-square)                           0.300

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    alcuse_14         1.000                           
    alcuse_15         1.000                           
    alcuse_16         1.000                           
  s =~                                                
    alcuse_14         0.000                           
    alcuse_15         1.000                           
    alcuse_16         2.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~                                                 
    cpeer             0.736    0.117    6.288    0.000
  s ~                                                 
    cpeer            -0.139    0.084   -1.656    0.098

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
 .i ~~                                                
   .s                -0.075    0.082   -0.912    0.362

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .alcuse_14         0.000                           
   .alcuse_15         0.000                           
   .alcuse_16         0.000                           
   .i                 0.642    0.085    7.562    0.000
   .s                 0.276    0.061    4.531    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .alcuse_14         0.175    0.124    1.416    0.157
   .alcuse_15         0.375    0.083    4.529    0.000
   .alcuse_16         0.349    0.175    1.990    0.047
   .i                 0.430    0.138    3.114    0.002
   .s                 0.177    0.076    2.312    0.021</code></pre>
</div>
</div>
</section>
<section id="multiple-predictors-1" class="slide level2">
<h2>Multiple predictors</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>sem<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="st">'  i =~ 1*alcuse_14 + 1*alcuse_15 + 1*alcuse_16 </span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="st">            s =~ 0*alcuse_14 + 1*alcuse_15 + 2*alcuse_16</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="st">               </span></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="st"># regressions</span></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="st">    </span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="st">    i ~ cpeer + male</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="st">    s ~ cpeer + male</span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="st">'</span></span>
<span id="cb36-9"><a href="#cb36-9"></a>fit<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">growth</span>(sem<span class="fl">.4</span>, <span class="at">data =</span> alcohol.wide)</span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="fu">summary</span>(fit<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-11 ended normally after 26 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        12
                                                      
  Number of observations                            82
                                                      
Model Test User Model:
                                                      
  Test statistic                                 5.134
  Degrees of freedom                                 3
  P-value (Chi-square)                           0.162

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    alcuse_14         1.000                           
    alcuse_15         1.000                           
    alcuse_16         1.000                           
  s =~                                                
    alcuse_14         0.000                           
    alcuse_15         1.000                           
    alcuse_16         2.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~                                                 
    cpeer             0.750    0.120    6.265    0.000
    male              0.105    0.174    0.603    0.546
  s ~                                                 
    cpeer            -0.107    0.084   -1.271    0.204
    male              0.241    0.122    1.977    0.048

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
 .i ~~                                                
   .s                -0.090    0.080   -1.132    0.257

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .alcuse_14         0.000                           
   .alcuse_15         0.000                           
   .alcuse_16         0.000                           
   .i                 0.587    0.123    4.783    0.000
   .s                 0.150    0.086    1.742    0.081

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .alcuse_14         0.162    0.123    1.316    0.188
   .alcuse_15         0.397    0.084    4.712    0.000
   .alcuse_16         0.274    0.166    1.649    0.099
   .i                 0.439    0.139    3.166    0.002
   .s                 0.183    0.074    2.480    0.013</code></pre>
</div>
</div>
</section>
<section id="centering-mlm-redux" class="slide level2">
<h2>Centering mlm redux</h2>
<p>Changing the scale of your predictors changes the interpretation of your model.</p>
<ol type="1">
<li><p>Original metric (no centering)</p></li>
<li><p>Group-mean centering (our group/nesting is person so this is also called person centering). This will be more appropriate when we talk about level 1 predictors.</p></li>
<li><p>Group grand-mean centering (centering around person avg)</p></li>
<li><p>Grand-mean centering (this is taking the average across every obs)</p></li>
<li><p>Centering on a value of theoretical or applied interest</p></li>
</ol>
</section>
<section id="time-considerations" class="slide level2">
<h2>Time considerations</h2>
<ul>
<li><p>We typically center time around each person’s initial time to make the intercept more interpretable. However, this can cause correlations between an intercept and a slope.</p></li>
<li><p>If high, the correlation can be problematic in terms of estimation. Often we center time in the middle of the repeated assessments to minimize this association.</p></li>
<li><p>Doing so is especially important if you want to use some variable to predict intercept and slope (or use intercept/slope to predict some variable).</p></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li><p>What if people don’t have the same number of assessment waves or the same timespan? Where do you center? One option, is to center within each person’s own time, regardless of whether it lines up with others. This is nice because it makes the <span class="math inline">\(\gamma_{00}\)</span> interpretable as the average score across people.</p></li>
<li><p>However, what is the average score? If you are looking at longitudinal data where people span in age from 20 to 80 and the time each person was in the study differed from 1 to 10 years. How do you interpret the average person intercept?</p></li>
<li><p>Thus you may want to center on something constant across people, like age. The <span class="math inline">\(\gamma_{00}\)</span> can now easily be interpreted as age 40, for example. Buuut, this results in wonky residual terms, perhaps leading to greater covariance between intercept and slope.</p></li>
</ul>
</section>
<section id="level-2-centering" class="slide level2">
<h2>Level 2 centering</h2>
<ul>
<li><p>Because level 2 is involved with cross-level interactions, it is always helpful to at least consider centering. For level 2, the centering options are much easier, as one can generally go with grand mean centering.</p></li>
<li><p>As everyone has only 1 value to contribute to, the calculation and the interpretation is more straightforward. It is thus also equivalent to group grand-mean centering.</p></li>
</ul>
</section>
<section class="slide level2">

<p>What are the interpretations for the coefficients for exercise centered vs non-centered?</p>
<p>level 1: <span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \varepsilon_{ti}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}Exercise_{i}  +   U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  \gamma_{11}Exercise_{i} +  U_{1i}\]</span></p>
<p>Combined: <span class="math display">\[\hat{Health}_{ti} = [\gamma_{00} + \gamma_{01}Exercise_{i}+  U_{0i}] + \]</span> <span class="math display">\[ [\gamma_{10}  + \gamma_{11}Exercise_{i} + U_{1i}]  * Time_{ti}\]</span></p>
</section>
<section id="level-1-predictors" class="slide level2">
<h2>Level 1 predictors</h2>
<ul>
<li><p>These are predictors that repeat.</p></li>
<li><p>Some variables that are inherently level 2 (e.g.&nbsp;handedness), some that make sense more as a level 1 (e.g., mood) and some that could be considered either depending on your research question and/or your data (e.g.&nbsp;income).</p></li>
<li><p>These variables can be treated as another predictor with the effect of “controlling” for some level 1 variable as well as a focal variable.</p></li>
</ul>
</section>
<section class="slide level2">

<p>Consider health across time (1 = yes, exercised).</p>
<p>level 1: <span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \beta_{2i}Exercise_{ti} + \varepsilon_{ti}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0i} = \gamma_{00} +   U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  U_{1i}\]</span></p>
<p><span class="math display">\[{\beta}_{2i} = \gamma_{20}\]</span></p>
<p>Combined:</p>
<p><span class="math display">\[{Health}_{ti} =  [\gamma_{00} +   \gamma_{10}Time_{ti}   + \gamma_{20}Exercise_{ti}] + \]</span><br>
</p>
<p><span class="math display">\[ [ U_{0i}  + U_{1i}Time_{ti}+ \varepsilon_{ti}]\]</span></p>
</section>
<section>
<section id="interpretation" class="title-slide slide level1 center">
<h1>Interpretation</h1>
<p>Tvs can be treated as another predictor with the effect of “controlling” for some TVC. Thus the regression coefficients in the model are conditional on this covariate.</p>
<p><span class="math inline">\(\gamma_{10}\)</span> is the average rate of change in health, controlling for exercise at each time point</p>
<p><span class="math inline">\(\gamma_{20}\)</span> is the average difference in health when exercising vs when not, across each time (so controlling for)</p>
<p><span class="math inline">\(\gamma_{00}\)</span> is the average health at Time = 0 for those that are not exercising. Ie when both predictors are at zero.</p>
</section>
<section class="slide level2">

<p>How would you visualize the fixed effects for varying combinations of exercise?</p>
</section>
<section id="what-if-time-is-not-focal" class="slide level2">
<h2>What if time is not focal?</h2>
<p>Usually time is not an important factor for studies that last for weeks or less. Instead we often we want to look at repeated associations or correlations across time. What happens to the time variable? Two options:</p>
<ol type="1">
<li><p>Ignore it. A time variable is asking whether the variable we care about is “associated” with time. Maybe that isn’t important to us, theoretically.</p></li>
<li><p>Use it to control to increases in your DV across time, but mostly disregard. Time could serve to control for the messiness of daily life, even if it is not a focal variable.</p></li>
</ol>
</section>
<section id="introducing-a-random-slope-for-a-tvc" class="slide level2">
<h2>Introducing a random slope for a TVC</h2>
<p>Person specific residuals make the interpretation of parameters a little more difficult as the model says that the gap between exercise and not exercise is the same for everyone. Should we allow it to be this way?</p>
<p>level 1:</p>
<p><span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \beta_{2i}Exercise_{ti} + \varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} +   U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  U_{1i}\]</span></p>
<p><span class="math display">\[{\beta}_{2i} = \gamma_{20} +  U_{2i}\]</span></p>
</section>
<section class="slide level2">

<p>Level 2 variance-covariance matrix:</p>
<p><span class="math display">\[\begin{pmatrix} {U}_{0i} \\ {U}_{1i} \\ {U}_{2i} \end{pmatrix} \sim \mathcal{N} \begin{pmatrix}  0,  &amp;  \tau_{0}^{2} &amp; \tau_{01}   &amp; \tau_{02}  \\  0, &amp; \tau_{10} &amp; \tau_{1}^{2} &amp; \tau_{12}  \\ 0, &amp; \tau_{20} &amp; \tau_{21} &amp; \tau_{2}^{2} \end{pmatrix}\]</span></p>
<p>Residual variance at level 1</p>
<p><span class="math display">\[{R}_{ti} \sim \mathcal{N}(0, \sigma^{2})\]</span></p>
</section>
<section id="where-does-the-variance-go" class="slide level2">
<h2>Where does the variance go?</h2>
<p>Compared to time invariant (level 2) predictors, tvc/level 1 predictors are likely to explain variance level 1 and level 2 variance terms. This is because level 1 predictors can include both level 1 and level 2 information.</p>
<p>Typically level 2 predictors tend to only reduce level 2 variance. It is possible, however, that including a level 1 predictor will increase the variance in level 2 variance components.</p>
</section>
<section id="interactions-among-level-1-variables" class="slide level2">
<h2>Interactions among level 1 variables</h2>
<p>Couldn’t exercise levels influence the slope of health? The previous models constrained the slopes to be the same, saying that people differ on level when exercising vs not but not on rate of change.</p>
<p><span class="math display">\[{Health}_{ti} =  [\gamma_{00} +   \gamma_{10}Time_{ti}   + \gamma_{20}Exercise_{ti} + \gamma_{30}TimeXExercise_{ti}]\]</span></p>
<p><span class="math display">\[+ [ U_{0i}  + U_{1i}Time_{ti}+ \varepsilon_{ti}]\]</span></p>
<ul>
<li><p>How could you visualize this model?</p></li>
<li><p>How do you interpret each of the terms (knowing what you know about interactions)?</p></li>
<li><p>How would all of this change if our level 1 variable was continuous?</p></li>
</ul>
</section>
<section id="centering-redux" class="slide level2">
<h2>Centering redux</h2>
<ul>
<li><p>If we just leave the exercise variable by itself there is often a combination of within and between person information. The two sources are “smushed” together.</p></li>
<li><p>I could exercise more than the average person (between person) but my research question is about what happens when <em>I</em> exercise a lot, does that correspond to health. Because my excercise level varies there is within person information.</p></li>
<li><p>It is not clear whether exercise is associated with health BECAUSE people who exercise tend to be healthier (a between person question that could be addressed with cross sectional data) or is it because when someone exercises they feel healthier.</p></li>
<li><p>How is <span class="math inline">\(\gamma_{20}Exercise_{ti}\)</span> interpreted?</p></li>
</ul>
</section>
<section id="person-mean-centering" class="slide level2">
<h2>person mean centering</h2>
<ul>
<li><p>Typically for level 1 we will want to within person-mean center to help with the issue of “smushed” variance. Especially when you are working with level 1 interactions, centering is important to interpret your lower order terms.</p></li>
<li><p>However, this gets rid of all mean level information for a person. The question at hand is not whether you exercise more or less it is compared to your typical levels, what happens when you exercise more or less.</p></li>
<li><p>If you are including a level 1 person centered variable in the model, note that 1) the average level of exercise is not controlled for and 2) the variation around the level will likely be related to the persons mean score. In other words, the within and between person variance of exercise is not neatly decomposed.</p></li>
</ul>
</section>
<section id="level-1-intensive-vs-long-term" class="slide level2">
<h2>Level 1 intensive vs long term</h2>
<ul>
<li><p>The question of whether to center or not at level 1 partially depends on the type of data we are analyzing.</p></li>
<li><p>For intensive data, we will want to center for two related reasons: 1. makes the coefficient about within person deviations and 2. helps us separate within and between person effects</p></li>
<li><p>For longer term data, level 1 is often used as a covariate rather than a focal coefficient. As a result, centering becomes less important.</p></li>
</ul>
</section>
<section id="seperating-between-and-within-person-effects" class="slide level2">
<h2>Seperating between and within person effects</h2>
<p>We will create a new variable out of the existing level 1 variable, a person mean. This makes the effects of the person level uncorrelated with the effects of the between person level</p>
<p><span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \beta_{2i}(Exercise_{ti}-\overline{Exercise_{i}}) + \varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}\overline{Exercise_{i}} + U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  U_{1i}\]</span></p>
<p><span class="math display">\[{\beta}_{2i} = \gamma_{20}\]</span></p>
</section>
<section class="slide level2">

<p>What would we be testing if we included included person mean exercise to the person level effect?</p>
<p><span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \beta_{2i}(Exercise_{ti}-\overline{Exercise_{i}}) + \varepsilon_{ti}\]</span></p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}\overline{Exercise_{i}} + U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  U_{1i}\]</span></p>
<p><span class="math display">\[{\beta}_{2i} = \gamma_{20}+ \gamma_{21}\overline{Exercise_{i}}\]</span></p>
</section>
<section id="multiple-level-1-predictors" class="slide level2">
<h2>Multiple level 1 predictors</h2>
<p><span class="math display">\[{Health}_{ti} =  [\gamma_{00} +   \gamma_{10}Time_{ti}   + \gamma_{20}(Exercise_{ti}-\overline{Exercise_{i}}) + \gamma_{30}Mood_{ti}\]</span></p>
<p><span class="math display">\[+\gamma_{40}(Mood*(Exercise_{ti}-\overline{Exercise_{i}}))_{ti} ] + [ U_{0i}  + U_{1i}Time_{ti}+ \varepsilon_{ti}]\]</span></p>
<p>How would <span class="math inline">\(\gamma_{20}\)</span> and <span class="math inline">\(\gamma_{40}\)</span> change in interpretation if exercise was not person centered?</p>
</section>
<section class="slide level2">

<p>Level 1:</p>
<p><span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \beta_{2i}(Exercise_{ti}-\overline{Exercise_{i}}) +\]</span></p>
<p><span class="math display">\[\beta_{3i}Mood_{ti}+\beta_{4i}Mood_{ti}*(Exercise_{ti}-\overline{Exercise_{i}})  +\varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}\overline{Exercise_{i}} + U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  U_{1i}\]</span></p>
<p><span class="math display">\[{\beta}_{2i} = \gamma_{20}\]</span></p>
<p><span class="math display">\[{\beta}_{3i} = \gamma_{30}\]</span></p>
<p><span class="math display">\[{\beta}_{4i} = \gamma_{40}\]</span></p>
</section>
<section class="slide level2">

<ul>
<li><p>For longer term data, where the focus is on a trajectory, and the fators that impact it, controlling for TVC like exercise often is done level 1 and not also at level 2.</p></li>
<li><p>The level 1 has both between and within person variance, and given you are not trying to seperate the influence, you end up controlling for both when putting in level 1 TVC.</p></li>
</ul>
</section>
<section id="what-happens-if-we-want-to-add-a-level-2-predictor" class="slide level2">
<h2>What happens if we want to add a level 2 predictor?</h2>
<p><span class="math display">\[{Health}_{ti} =  [\gamma_{00} + \gamma_{10}Time_{ti} + \gamma_{20}(Exercise_{ti}-\overline{Exercise_{i}}) +\gamma_{30}Mood_{ti}+\gamma_{31}(Mood*\overline{Exercise_{i}})_{ti}\]</span></p>
<p><span class="math display">\[+\gamma_{40}(Mood*(Exercise_{ti}-\overline{Exercise_{i}}))_{ti} ] + [ U_{0i}  + U_{1i}Time_{ti}+ \varepsilon_{ti}]\]</span></p>
</section>
<section class="slide level2">

<p>Level 1:</p>
<p><span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \beta_{2i}(Exercise_{ti}-\overline{Exercise_{i}}) + \beta_{3i}Mood_{ti} +\varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}\overline{Exercise_{i}} + U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  U_{1i}\]</span></p>
<p><span class="math display">\[{\beta}_{2i} = \gamma_{20}\]</span></p>
<p><span class="math display">\[{\beta}_{3i} = \gamma_{30} + \gamma_{31}  (\overline{Exercise_{i}})\]</span></p>
</section>
<section id="lagged-models" class="slide level2">
<h2>Lagged models</h2>
<p>What if I want to predict something in the future?</p>
<p>Level 1</p>
<p><span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \beta_{2i}(Exercise_{(t-1)i}-\overline{Exercise_{i}}) + \varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}\overline{Exercise_{i}} + U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} + \gamma_{11}\overline{Exercise_{i}} + U_{1i}\]</span></p>
<p><span class="math display">\[{\beta}_{2i} = \gamma_{20}\]</span></p>
</section>
<section class="slide level2">

<p>How does this model differ from the prior model? What does the <span class="math inline">\(\gamma_{21}\)</span> test? Would you want to include this term or not?</p>
<p>Level 1</p>
<p><span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \beta_{2i}(Exercise_{(t-1)i}-\overline{Exercise_{i}}) + \varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}\overline{Exercise_{i}} + U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} + \gamma_{11}\overline{Exercise_{i}} + U_{1i}\]</span></p>
<p><span class="math display">\[{\beta}_{2i} = \gamma_{20} + \gamma_{21}\overline{Exercise_{i}}\]</span></p>
</section>
<section id="contextual-models" class="slide level2">
<h2>Contextual models</h2>
<p>Grand mean centering our level 1 variables is another option. We have already seen that when we use time as level 1 predictor. The between and within person variance is now “smushed” together when we do not person center.</p>
<p>Level 1:</p>
<p><span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \beta_{2i}(Exercise_{ti}-\overline{Exercise_{..}}) + \varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}(\overline{Exercise_{i}}-\overline{Exercise_{..}})+ U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  U_{1i}\]</span></p>
<p><span class="math display">\[{\beta}_{2i} = \gamma_{20}\]</span></p>
</section>
<section class="slide level2">

<p>When <span class="math inline">\(\gamma_{01}\overline{Exercise_{i}}\)</span> is included at level 2 when we have person-centered level 1 the effects separate the between and within. But level 2 controls for between meaning that <span class="math inline">\(\beta_{2i}(Exercise_{ti}-\overline{Exercise_{..}})\)</span> is now the within person effect, same as if we within person centered!</p>
</section>
<section class="slide level2">

<p>How to interpret <span class="math inline">\(\gamma_{01}\overline{Exercise_{i}}\)</span> ?</p>
<p>The extent that daily exercise is higher for a given person than for the rest of the sample, we can expect that person’s mean exercise to be higher than the rest of the sample as well. Thus, part of the between-person effect can be captured just by including time-varying, level 1 exercise. As a result, <span class="math inline">\(\gamma_{01}\overline{Exercise_{i}}\)</span> represents the difference needed to get from the part of the between person effect carried by just level 1 to the total between-person effect that belongs in the level-2 model</p>
<p>After controlling for the absolute amount of timevarying exercise, the incremental (unique) effect of average exercise is given by its level-2 contextual effect. For every unit higher person mean exercise, mean daily exercise are expected to be higher by the level-2 contextual effect.</p>
<p>In summary, similar in interpretation to the within and between separation. The contextual effect = between effect minus within person effect</p>
<table style="width:11%;">
<colgroup>
<col style="width: 11%">
</colgroup>
<tbody>
<tr class="odd">
<td>centering and random effects</td>
</tr>
<tr class="even">
<td>Level 1</td>
</tr>
<tr class="odd">
<td><span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}(Exercise_{ti}-\overline{Exercise_{i}}) + \varepsilon_{ti}\]</span></td>
</tr>
<tr class="even">
<td><span class="math display">\[{Health}_{ti} = \beta_{0i} +  \beta_{1i}(Exercise_{ti}-\overline{Exercise_{..}}) + \varepsilon_{ti}\]</span></td>
</tr>
<tr class="odd">
<td>Level 2:</td>
</tr>
<tr class="even">
<td><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}(\overline{Exercise_{i}}-\overline{Exercise_{..}}) + U_{0i}\]</span></td>
</tr>
<tr class="odd">
<td><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  U_{1i}\]</span></td>
</tr>
<tr class="even">
<td>Interpretation:</td>
</tr>
<tr class="odd">
<td><span class="math display">\[U_{1i}\]</span></td>
</tr>
<tr class="even">
<td>For PMC, the effect is relative association compared to typical person centered effect – maybe some people have an effect where deviations of exercise influences health but others these deviations do not. For GMC, the effect contains both within and between person effects, so the interpretation is messier</td>
</tr>
</tbody>
</table>
<p>Level 1</p>
<p><span class="math display">\[{Health}_{ti} = \beta_{0i}  + \beta_{1i}(Exercise_{ti}-\overline{Exercise_{i}}) + \varepsilon_{ti}\]</span></p>
<p><span class="math display">\[{Health}_{ti} = \beta_{0i} +  \beta_{1i}(Exercise_{ti}-\overline{Exercise_{..}}) + \varepsilon_{ti}\]</span></p>
<p>Level 2:</p>
<p><span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}(\overline{Exercise_{i}}-\overline{Exercise_{..}}) + U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} +  U_{1i}\]</span></p>
<p>Interpretation:</p>
<p><span class="math display">\[U_{0i}\]</span></p>
<p>For PMC, the effect represents intercept differences when people are at their person mean. Are they healthier than the avg person, at their avg level of exercise? For GMC, the effect when people are at the grand mean. Are they healthier than the at the average level of exercise?</p>
</section>
<section id="categorical-tvc" class="slide level2">
<h2>categorical TVC</h2>
<p>Depending on your goal it might be confusing/difficult to person mean center. The issue is that centering in this manner leads to values that do not exist e.g.&nbsp;-.5 when your TVC = 0, for example. This also leads to potentially strange/uninterpretable intercepts or other lower order terms.</p>
<p>Suggested to keep raw tvc at level 1 but GMC at level 2.</p>
<p>Sometimes time variables can be like this. For a recent paper we coded a life event as a tvc, which effectively switched on and of when the person encountered a life event.</p>
<table>
<thead>
<tr class="header">
<th>ID</th>
<th style="text-align: center;">wave</th>
<th style="text-align: right;">event</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td style="text-align: center;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>1</td>
<td style="text-align: center;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>1</td>
<td style="text-align: center;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>2</td>
<td style="text-align: center;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td>2</td>
<td style="text-align: center;">1</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</section>
<section id="sem-tvcs" class="slide level2">
<h2>SEM TVCs</h2>
<p>Level 1 variables (tvs) are flexibly handled in SEM. Whereas previously a level 1 variable had a constant effect (ie you just had a single parameter) here you can model separate effects for different times. Or you can have a tvc for one timepoint but not another. Doing this in an MLM framework is awkward at best.</p>
<div class="cell">

</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>model<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="st">'  i =~ 1*alcuse_14 + 1*alcuse_15 + 1*alcuse_16 </span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="st">            s =~ 0*alcuse_14 + .5*alcuse_15 + 1*alcuse_16</span></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="st">               </span></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="st"># regressions</span></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="st">    </span></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="st">    i ~ male + cpeer</span></span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="st">    s ~ male + cpeer</span></span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="st">    </span></span>
<span id="cb38-9"><a href="#cb38-9"></a><span class="st"># time-varying covariates</span></span>
<span id="cb38-10"><a href="#cb38-10"></a></span>
<span id="cb38-11"><a href="#cb38-11"></a><span class="st">    alcuse_14 ~ tvc1</span></span>
<span id="cb38-12"><a href="#cb38-12"></a><span class="st">    alcuse_15 ~ tvc2</span></span>
<span id="cb38-13"><a href="#cb38-13"></a><span class="st">    alcuse_16 ~ tvc3</span></span>
<span id="cb38-14"><a href="#cb38-14"></a></span>
<span id="cb38-15"><a href="#cb38-15"></a><span class="st">'</span></span>
<span id="cb38-16"><a href="#cb38-16"></a>fit<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">growth</span>(model<span class="fl">.5</span>, <span class="at">data =</span> alcohol.wide)</span>
<span id="cb38-17"><a href="#cb38-17"></a></span>
<span id="cb38-18"><a href="#cb38-18"></a><span class="fu">summary</span>(fit<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-11 ended normally after 28 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        15
                                                      
  Number of observations                            82
                                                      
Model Test User Model:
                                                      
  Test statistic                                10.680
  Degrees of freedom                                 9
  P-value (Chi-square)                           0.298

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    alcuse_14         1.000                           
    alcuse_15         1.000                           
    alcuse_16         1.000                           
  s =~                                                
    alcuse_14         0.000                           
    alcuse_15         0.500                           
    alcuse_16         1.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~                                                 
    male              0.096    0.177    0.541    0.589
    cpeer             0.743    0.121    6.140    0.000
  s ~                                                 
    male              0.490    0.248    1.973    0.048
    cpeer            -0.215    0.170   -1.266    0.205
  alcuse_14 ~                                         
    tvc1             -0.021    0.072   -0.289    0.772
  alcuse_15 ~                                         
    tvc2              0.029    0.078    0.370    0.711
  alcuse_16 ~                                         
    tvc3             -0.132    0.098   -1.348    0.178

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
 .i ~~                                                
   .s                -0.198    0.157   -1.261    0.207

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .alcuse_14         0.000                           
   .alcuse_15         0.000                           
   .alcuse_16         0.000                           
   .i                 0.590    0.123    4.796    0.000
   .s                 0.269    0.174    1.545    0.122

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .alcuse_14         0.152    0.121    1.252    0.211
   .alcuse_15         0.398    0.084    4.748    0.000
   .alcuse_16         0.230    0.163    1.412    0.158
   .i                 0.448    0.138    3.247    0.001
   .s                 0.791    0.293    2.701    0.007</code></pre>
</div>
</div>
<p>Can we fix the TVCs to be the same?</p>
</section>
<section id="melsm" class="slide level2">
<h2>MELSM</h2>
<p>Mixed effects location scale model location = mean scale = variance (usually)</p>
<p>Basically it means modeling multiple distributional parameters simultaneously.</p>
<div class="cell">

</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="fu">distinct</span>(record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    n
1 193</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Participants filled out daily affective measures and physical activity</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2"></a>    <span class="fu">count</span>(record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n)) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"number of days"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-25-1.png" width="960" class="r-stretch"></section>
<section id="participant-level" class="slide level2">
<h2>Participant level</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="sc">!</span>record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">16</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-4"><a href="#cb43-4"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb43-5"><a href="#cb43-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> N_A.lag)) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8"></a>  <span class="fu">ylab</span>(<span class="st">"negative affect (standardized)"</span>) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>record_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch"></section>
<section id="standard-mlm-treatment" class="slide level2">
<h2>Standard MLM treatment</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb44-2"><a href="#cb44-2"></a>melsm<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb44-4"><a href="#cb44-4"></a>      N_A.std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span> record_id),</span>
<span id="cb44-5"><a href="#cb44-5"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb44-6"><a href="#cb44-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb44-7"><a href="#cb44-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb44-8"><a href="#cb44-8"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb44-9"><a href="#cb44-9"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb44-10"><a href="#cb44-10"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb44-11"><a href="#cb44-11"></a>      <span class="at">data =</span> melsm,</span>
<span id="cb44-12"><a href="#cb44-12"></a>      <span class="at">file =</span> <span class="st">"melsm.1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">summary</span>(melsm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: N_A.std ~ 1 + day01 + (1 + day01 | record_id) 
   Data: melsm (Number of observations: 13033) 
  Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 8000

Group-Level Effects: 
~record_id (Number of levels: 193) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.77      0.04     0.70     0.86 1.00     1220
sd(day01)                0.65      0.04     0.57     0.74 1.00     2747
cor(Intercept,day01)    -0.34      0.08    -0.49    -0.19 1.00     2811
                     Tail_ESS
sd(Intercept)            2299
sd(day01)                4628
cor(Intercept,day01)     4574

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.03      0.06    -0.08     0.14 1.01      913     1695
day01        -0.16      0.06    -0.27    -0.04 1.00     2566     4152

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.61      0.00     0.60     0.62 1.00    14042     5613

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(N_A.std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span> record_id), <span class="at">data =</span> melsm)</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: N_A.std ~ 1 + day01 + (1 + day01 | record_id)
   Data: melsm

REML criterion at convergence: 25306

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.8349 -0.4655 -0.0216  0.4181  8.4702 

Random effects:
 Groups    Name        Variance Std.Dev. Corr 
 record_id (Intercept) 0.5942   0.7708        
           day01       0.4196   0.6478   -0.36
 Residual              0.3734   0.6110        
Number of obs: 13033, groups:  record_id, 193

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.02853    0.05649   0.505
day01       -0.15926    0.05576  -2.856

Correlation of Fixed Effects:
      (Intr)
day01 -0.368</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>If we do not care about random effects, specify re_formula = NA</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb49-2"><a href="#cb49-2"></a>fixed.slope<span class="ot">&lt;-</span> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="#cb49-4"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NA</span> )</span>
<span id="cb49-5"><a href="#cb49-5"></a>  fixed.slope</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160,000 × 6
# Groups:   day01, .row [20]
   day01  .row .chain .iteration .draw .epred
   &lt;dbl&gt; &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
 1     0     1     NA         NA     1 0.0680
 2     0     1     NA         NA     2 0.0388
 3     0     1     NA         NA     3 0.0315
 4     0     1     NA         NA     4 0.0407
 5     0     1     NA         NA     5 0.0363
 6     0     1     NA         NA     6 0.0128
 7     0     1     NA         NA     7 0.0531
 8     0     1     NA         NA     8 0.0836
 9     0     1     NA         NA     9 0.0961
10     0     1     NA         NA    10 0.0742
# … with 159,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>If we want random effects we need to specify the variable to get ALL levels.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,860 × 2
   day01 record_id
   &lt;dbl&gt;     &lt;int&gt;
 1     0         1
 2     0         2
 3     0         3
 4     0         4
 5     0         5
 6     0         6
 7     0         7
 8     0         8
 9     0         9
10     0        10
# … with 3,850 more rows</code></pre>
</div>
</div>
<p>193 people * 20 = 3860</p>
</section>
<section class="slide level2">

<p>Then we need to state re_forumla = NULL (which is the default)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NULL</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30,880,000 × 7
# Groups:   day01, record_id, .row [3,860]
   day01 record_id  .row .chain .iteration .draw .epred
   &lt;dbl&gt;     &lt;int&gt; &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
 1     0         1     1     NA         NA     1 0.333 
 2     0         1     1     NA         NA     2 0.225 
 3     0         1     1     NA         NA     3 0.237 
 4     0         1     1     NA         NA     4 0.0955
 5     0         1     1     NA         NA     5 0.193 
 6     0         1     1     NA         NA     6 0.144 
 7     0         1     1     NA         NA     7 0.280 
 8     0         1     1     NA         NA     8 0.0884
 9     0         1     1     NA         NA     9 0.205 
10     0         1     1     NA         NA    10 0.0894
# … with 30,879,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>re_formula formula helps us focus on either the average trajectory (gammas) or the group specific (person Us). If NULL (default), include all group-level effects; if NA, include no group-level effects.</p>
<p>160,000 = 20 (different values of X we chose) x 8000 iterations (2k x 4 chains) 30,880,000 = 20* 8000 iterations * 193 people in our dataset</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-4"><a href="#cb55-4"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5"></a>  <span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> .epred) <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fl">0.95</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="do">## https://www.tjmahr.com/sample-n-groups/</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>sample_n_of <span class="ot">&lt;-</span> <span class="cf">function</span>(data, size, ...) {</span>
<span id="cb56-3"><a href="#cb56-3"></a>  dots <span class="ot">&lt;-</span> <span class="fu">quos</span>(...)</span>
<span id="cb56-4"><a href="#cb56-4"></a>  group_ids <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="#cb56-5"></a>    <span class="fu">group_by</span>(<span class="sc">!!!</span> dots) <span class="sc">%&gt;%</span> </span>
<span id="cb56-6"><a href="#cb56-6"></a>    <span class="fu">group_indices</span>()</span>
<span id="cb56-7"><a href="#cb56-7"></a>  sampled_groups <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">unique</span>(group_ids), size)</span>
<span id="cb56-8"><a href="#cb56-8"></a>  data <span class="sc">%&gt;%</span> </span>
<span id="cb56-9"><a href="#cb56-9"></a>    <span class="fu">filter</span>(group_ids <span class="sc">%in%</span> sampled_groups)</span>
<span id="cb56-10"><a href="#cb56-10"></a>}</span>
<span id="cb56-11"><a href="#cb56-11"></a></span>
<span id="cb56-12"><a href="#cb56-12"></a>sample_n_of <span class="ot">&lt;-</span> <span class="cf">function</span>(data, size, ...) {</span>
<span id="cb56-13"><a href="#cb56-13"></a>  dots <span class="ot">&lt;-</span> <span class="fu">quos</span>(...)</span>
<span id="cb56-14"><a href="#cb56-14"></a>  </span>
<span id="cb56-15"><a href="#cb56-15"></a>  group_ids <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb56-16"><a href="#cb56-16"></a>    <span class="fu">group_by</span>(<span class="sc">!!!</span> dots) <span class="sc">%&gt;%</span> </span>
<span id="cb56-17"><a href="#cb56-17"></a>    <span class="fu">group_indices</span>()</span>
<span id="cb56-18"><a href="#cb56-18"></a>  </span>
<span id="cb56-19"><a href="#cb56-19"></a>  sampled_groups <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">unique</span>(group_ids), size)</span>
<span id="cb56-20"><a href="#cb56-20"></a>  </span>
<span id="cb56-21"><a href="#cb56-21"></a>  data <span class="sc">%&gt;%</span> </span>
<span id="cb56-22"><a href="#cb56-22"></a>    <span class="fu">filter</span>(group_ids <span class="sc">%in%</span> sampled_groups)</span>
<span id="cb56-23"><a href="#cb56-23"></a>}</span>
<span id="cb56-24"><a href="#cb56-24"></a></span>
<span id="cb56-25"><a href="#cb56-25"></a></span>
<span id="cb56-26"><a href="#cb56-26"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb56-27"><a href="#cb56-27"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb56-28"><a href="#cb56-28"></a>    <span class="fu">sample_n_of</span>(<span class="dv">5</span>,record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb56-29"><a href="#cb56-29"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-30"><a href="#cb56-30"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01)) <span class="sc">+</span></span>
<span id="cb56-31"><a href="#cb56-31"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred, <span class="at">group =</span> record_id))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"></section>
<section id="sigma-is-unmodeled-variation" class="slide level2">
<h2>Sigma is unmodeled variation</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>newd <span class="ot">&lt;-</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>  melsm <span class="sc">%&gt;%</span> </span>
<span id="cb57-3"><a href="#cb57-3"></a>  <span class="fu">filter</span>(record_id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">115</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-4"><a href="#cb57-4"></a>  <span class="fu">select</span>(record_id, N_A.std, day01)</span>
<span id="cb57-5"><a href="#cb57-5"></a></span>
<span id="cb57-6"><a href="#cb57-6"></a>fits <span class="ot">&lt;-</span> newd <span class="sc">%&gt;%</span></span>
<span id="cb57-7"><a href="#cb57-7"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>)</span>
<span id="cb57-8"><a href="#cb57-8"></a></span>
<span id="cb57-9"><a href="#cb57-9"></a>preds <span class="ot">&lt;-</span> newd <span class="sc">%&gt;%</span></span>
<span id="cb57-10"><a href="#cb57-10"></a>  <span class="fu">add_predicted_draws</span>(melsm<span class="fl">.1</span>)</span>
<span id="cb57-11"><a href="#cb57-11"></a></span>
<span id="cb57-12"><a href="#cb57-12"></a>fits <span class="sc">%&gt;%</span> </span>
<span id="cb57-13"><a href="#cb57-13"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> N_A.std)) <span class="sc">+</span></span>
<span id="cb57-14"><a href="#cb57-14"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">95</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span><span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb57-15"><a href="#cb57-15"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">data =</span> preds, <span class="fu">aes</span>(<span class="at">y =</span> .prediction),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb57-16"><a href="#cb57-16"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> newd) <span class="sc">+</span></span>
<span id="cb57-17"><a href="#cb57-17"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>record_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-35-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p><span class="math display">\[NA_{ij} \sim \operatorname{Normal}(\mu_{ij}, \sigma_{i})\]</span></p>
<p><span class="math display">\[\mu_{ij}  = \beta_0 + \beta_1 time_{ij} + u_{0i} + u_{1i} time_{ij}\]</span></p>
<p><span class="math display">\[\log(\sigma_i )  = \eta_0 + u_{2i}\]</span></p>
<p><span class="math display">\[\begin{bmatrix} u_{0i} \\ u_{1i} \\ {u_{2i}} \end{bmatrix}  \sim \operatorname{MVNormal}\begin{pmatrix} \begin{bmatrix} 0 \\ 0 \\ 0 \end{bmatrix}, \mathbf S \mathbf R \mathbf S \end{pmatrix}\]</span></p>
<p><span class="math display">\[\mathbf S  = \begin{bmatrix} \sigma_0 &amp; 0 &amp; 0 \\ 0 &amp; \sigma_1 &amp; 0 \\ 0 &amp; 0 &amp; \sigma_2 \end{bmatrix}\]</span></p>
<p><span class="math display">\[\mathbf R = \begin{bmatrix} 1 &amp; \rho_{12} &amp; \rho_{13} \\ \rho_{21} &amp; 1 &amp; \rho_{23} \\ \rho_{31} &amp; \rho_{32} &amp; 1 \end{bmatrix}\]</span></p>
<p><span class="math display">\[\beta_0  \sim \operatorname{Normal}(0, 0.2)\]</span></p>
<p><span class="math display">\[\beta_1 \text{and } \eta_0  \sim \operatorname{Normal}(0, 1) \]</span></p>
<p><span class="math display">\[ \sigma_0,\dots, \sigma_2 \sim \operatorname{Exponential}(1) \]</span></p>
<p><span class="math display">\[\mathbf R  \sim \operatorname{LKJ}(2)\]</span></p>
</section>
<section class="slide level2">

<p>note: 1) brms default is to use log-link when modeling sigma 2) |i| syntax within the parentheses allow for correlated random effects. Without this, the random intercept and slope would not be correlated with the random sigma term, effectively setting the correlation equal to zero</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>melsm<span class="fl">.2</span> <span class="ot">&lt;-</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb58-3"><a href="#cb58-3"></a>      <span class="fu">bf</span>(N_A.std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span>i<span class="sc">|</span> record_id),</span>
<span id="cb58-4"><a href="#cb58-4"></a>         sigma <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span>i<span class="sc">|</span> record_id)),</span>
<span id="cb58-5"><a href="#cb58-5"></a>                <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb58-6"><a href="#cb58-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb58-7"><a href="#cb58-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb58-8"><a href="#cb58-8"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept, <span class="at">dpar =</span> sigma),</span>
<span id="cb58-9"><a href="#cb58-9"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">dpar =</span> sigma),</span>
<span id="cb58-10"><a href="#cb58-10"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb58-11"><a href="#cb58-11"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb58-12"><a href="#cb58-12"></a>      <span class="at">data =</span> melsm,</span>
<span id="cb58-13"><a href="#cb58-13"></a>      <span class="at">file =</span> <span class="st">"melsm.2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">summary</span>(melsm<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = log 
Formula: N_A.std ~ 1 + day01 + (1 + day01 | i | record_id) 
         sigma ~ 1 + (1 | i | record_id)
   Data: melsm (Number of observations: 13033) 
  Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 8000

Group-Level Effects: 
~record_id (Number of levels: 193) 
                               Estimate Est.Error l-95% CI u-95% CI Rhat
sd(Intercept)                      0.76      0.04     0.69     0.85 1.01
sd(day01)                          0.60      0.04     0.53     0.70 1.00
sd(sigma_Intercept)                0.69      0.04     0.63     0.77 1.01
cor(Intercept,day01)              -0.34      0.08    -0.49    -0.17 1.00
cor(Intercept,sigma_Intercept)     0.61      0.05     0.52     0.70 1.00
cor(day01,sigma_Intercept)        -0.10      0.08    -0.26     0.07 1.01
                               Bulk_ESS Tail_ESS
sd(Intercept)                       464      857
sd(day01)                          1289     2193
sd(sigma_Intercept)                 668     1206
cor(Intercept,day01)                849     1809
cor(Intercept,sigma_Intercept)      565     1135
cor(day01,sigma_Intercept)          542     1302

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           0.03      0.05    -0.07     0.14 1.01      234      564
sigma_Intercept    -0.78      0.05    -0.88    -0.68 1.00      381      950
day01              -0.16      0.05    -0.26    -0.05 1.00      640     1231

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>melsm<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="fu">spread_draws</span>(b_sigma_Intercept) <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="fu">exp</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb61-4"><a href="#cb61-4"></a>  <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  b_sigma_Intercept .lower .upper .width .point .interval
              &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1             0.458  0.415  0.505   0.95 median qi       </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>melsm<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2"></a>  <span class="fu">spread_draws</span>(b_day01) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3"></a>  <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  b_day01 .lower  .upper .width .point .interval
    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1  -0.159 -0.258 -0.0547   0.95 median qi       </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>melsm<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="fu">spread_draws</span>(b_sigma_Intercept,r_record_id__sigma[ID, term]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,544,000 × 7
# Groups:   ID, term [193]
   .chain .iteration .draw b_sigma_Intercept    ID term      r_record_id__sigma
    &lt;int&gt;      &lt;int&gt; &lt;int&gt;             &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;                  &lt;dbl&gt;
 1      1          1     1            -0.828     1 Intercept              0.510
 2      1          1     1            -0.828     2 Intercept             -0.994
 3      1          1     1            -0.828     3 Intercept              0.115
 4      1          1     1            -0.828     4 Intercept              0.793
 5      1          1     1            -0.828     5 Intercept             -0.837
 6      1          1     1            -0.828     6 Intercept              0.367
 7      1          1     1            -0.828     7 Intercept              0.108
 8      1          1     1            -0.828     8 Intercept             -0.901
 9      1          1     1            -0.828     9 Intercept             -0.444
10      1          1     1            -0.828    10 Intercept             -0.167
# … with 1,543,990 more rows</code></pre>
</div>
</div>
<p>8000 samples * 193 participants = 1544000</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>melsm<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="fu">spread_draws</span>(b_sigma_Intercept,r_record_id__sigma[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb67-3"><a href="#cb67-3"></a>  <span class="fu">mutate</span>(<span class="at">b_sigma_Intercept =</span> <span class="fu">exp</span>(b_sigma_Intercept)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-4"><a href="#cb67-4"></a>  <span class="fu">mutate</span>(<span class="at">r_record_id__sigma =</span> <span class="fu">exp</span>(r_record_id__sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-5"><a href="#cb67-5"></a>   <span class="fu">median_qi</span>(<span class="at">estimate =</span> b_sigma_Intercept <span class="sc">+</span> r_record_id__sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb67-6"><a href="#cb67-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ID, estimate), <span class="at">y =</span> estimate, <span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7"></a>   <span class="fu">geom_pointinterval</span>(<span class="at">point_colour =</span> <span class="st">"black"</span>, <span class="at">interval_color =</span> <span class="st">"grey"</span>, <span class="at">point_alpha =</span> .<span class="dv">25</span>) <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="st">"Participants ranked by posterior SD"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"sigma estimate"</span>) <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-41-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>fits2 <span class="ot">&lt;-</span> newd <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.2</span>)</span>
<span id="cb68-3"><a href="#cb68-3"></a></span>
<span id="cb68-4"><a href="#cb68-4"></a>preds2 <span class="ot">&lt;-</span> newd <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="#cb68-5"></a>  <span class="fu">add_predicted_draws</span>(melsm<span class="fl">.2</span>)</span>
<span id="cb68-6"><a href="#cb68-6"></a></span>
<span id="cb68-7"><a href="#cb68-7"></a>fits2 <span class="sc">%&gt;%</span> </span>
<span id="cb68-8"><a href="#cb68-8"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> N_A.std)) <span class="sc">+</span></span>
<span id="cb68-9"><a href="#cb68-9"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">95</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span><span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb68-10"><a href="#cb68-10"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">data =</span> preds2, <span class="fu">aes</span>(<span class="at">y =</span> .prediction),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb68-11"><a href="#cb68-11"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> newd) <span class="sc">+</span></span>
<span id="cb68-12"><a href="#cb68-12"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>record_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-42-1.png" width="960" class="r-stretch"></section>
<section id="time-as-a-predictor-of-sigma" class="slide level2">
<h2>time as a predictor of sigma</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>melsm<span class="fl">.3</span> <span class="ot">&lt;-</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb69-3"><a href="#cb69-3"></a>      <span class="fu">bf</span>(N_A.std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span>i<span class="sc">|</span> record_id),</span>
<span id="cb69-4"><a href="#cb69-4"></a>         sigma <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span>i<span class="sc">|</span> record_id)),</span>
<span id="cb69-5"><a href="#cb69-5"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb69-6"><a href="#cb69-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb69-7"><a href="#cb69-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb69-8"><a href="#cb69-8"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept, <span class="at">dpar =</span> sigma),</span>
<span id="cb69-9"><a href="#cb69-9"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">dpar =</span> sigma),</span>
<span id="cb69-10"><a href="#cb69-10"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">dpar =</span> sigma),</span>
<span id="cb69-11"><a href="#cb69-11"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb69-12"><a href="#cb69-12"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb69-13"><a href="#cb69-13"></a>      <span class="at">data =</span> melsm,</span>
<span id="cb69-14"><a href="#cb69-14"></a>      <span class="at">file =</span> <span class="st">"melsm.3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="fu">summary</span>(melsm<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = log 
Formula: N_A.std ~ 1 + day01 + (1 + day01 | i | record_id) 
         sigma ~ 1 + day01 + (1 + day01 | i | record_id)
   Data: melsm (Number of observations: 13033) 
  Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 8000

Group-Level Effects: 
~record_id (Number of levels: 193) 
                                 Estimate Est.Error l-95% CI u-95% CI Rhat
sd(Intercept)                        0.76      0.04     0.68     0.84 1.00
sd(day01)                            0.60      0.04     0.52     0.69 1.00
sd(sigma_Intercept)                  0.70      0.04     0.63     0.78 1.00
sd(sigma_day01)                      0.36      0.04     0.29     0.44 1.00
cor(Intercept,day01)                -0.31      0.08    -0.47    -0.14 1.00
cor(Intercept,sigma_Intercept)       0.64      0.05     0.54     0.72 1.00
cor(day01,sigma_Intercept)          -0.21      0.08    -0.35    -0.05 1.00
cor(Intercept,sigma_day01)          -0.16      0.11    -0.37     0.04 1.00
cor(day01,sigma_day01)               0.61      0.09     0.42     0.77 1.00
cor(sigma_Intercept,sigma_day01)    -0.15      0.10    -0.34     0.04 1.00
                                 Bulk_ESS Tail_ESS
sd(Intercept)                        1297     2298
sd(day01)                            2811     4050
sd(sigma_Intercept)                  1926     3114
sd(sigma_day01)                      4553     5964
cor(Intercept,day01)                 1850     3076
cor(Intercept,sigma_Intercept)       2011     3402
cor(day01,sigma_Intercept)           1480     2644
cor(Intercept,sigma_day01)           5538     6097
cor(day01,sigma_day01)               4644     5020
cor(sigma_Intercept,sigma_day01)     4828     6421

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           0.03      0.05    -0.07     0.14 1.01      571     1365
sigma_Intercept    -0.75      0.05    -0.85    -0.65 1.00      894     2102
day01              -0.15      0.05    -0.26    -0.05 1.00     1562     2806
sigma_day01        -0.11      0.04    -0.18    -0.03 1.00     4551     6258

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="#cb72-2"></a>  <span class="fu">gather_draws</span>(b_sigma_Intercept, b_sigma_day01) <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="#cb72-3"></a>  <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  .variable         .value .lower  .upper .width .point .interval
  &lt;chr&gt;              &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1 b_sigma_day01     -0.107 -0.183 -0.0293   0.95 median qi       
2 b_sigma_Intercept -0.748 -0.849 -0.648    0.95 median qi       </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="#cb74-2"></a>  <span class="fu">spread_draws</span>(b_sigma_Intercept) <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="#cb74-3"></a>  <span class="fu">mutate</span>(<span class="at">sigma_day0 =</span> <span class="fu">exp</span>(b_sigma_Intercept)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-4"><a href="#cb74-4"></a>  <span class="fu">select</span>(sigma_day0) <span class="sc">%&gt;%</span> </span>
<span id="cb74-5"><a href="#cb74-5"></a>  <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  sigma_day0 .lower .upper .width .point .interval
       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1      0.473  0.428  0.523   0.95 median qi       </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb76-2"><a href="#cb76-2"></a>  <span class="fu">spread_draws</span>(b_sigma_Intercept, b_sigma_day01) <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="#cb76-3"></a>  <span class="fu">mutate</span>(<span class="at">sigma_day1 =</span> <span class="fu">exp</span>(b_sigma_Intercept <span class="sc">+</span> b_sigma_day01)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-4"><a href="#cb76-4"></a>  <span class="fu">select</span>(sigma_day1) <span class="sc">%&gt;%</span> </span>
<span id="cb76-5"><a href="#cb76-5"></a>  <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  sigma_day1 .lower .upper .width .point .interval
       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1      0.425  0.380  0.476   0.95 median qi       </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), <span class="at">.model =</span> melsm) <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="#cb78-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.3</span>, <span class="at">re_formula =</span> <span class="cn">NA</span>, <span class="at">dpar =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb78-4"><a href="#cb78-4"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb78-5"><a href="#cb78-5"></a>  <span class="fu">select</span>(day01, .epred, sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160,000 × 3
   day01   .epred sigma
   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1     0  0.00469 0.484
 2     0  0.0452  0.494
 3     0 -0.00387 0.484
 4     0 -0.00754 0.467
 5     0  0.0198  0.473
 6     0  0.0265  0.496
 7     0  0.0509  0.517
 8     0  0.0910  0.480
 9     0  0.0772  0.500
10     0  0.107   0.479
# … with 159,990 more rows</code></pre>
</div>
</div>
<p>20 * 8000 = 160000</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb80-2"><a href="#cb80-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), <span class="at">.model =</span> melsm) <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.3</span>, <span class="at">re_formula =</span> <span class="cn">NA</span>, <span class="at">dpar =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb80-4"><a href="#cb80-4"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb80-5"><a href="#cb80-5"></a>  <span class="fu">select</span>(day01, .epred, sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb80-6"><a href="#cb80-6"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb80-7"><a href="#cb80-7"></a>  <span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> sigma) <span class="sc">+</span></span>
<span id="cb80-8"><a href="#cb80-8"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fl">0.95</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-49-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Lets look at random effects. Remember we fit a random effect for both the intercept and the slope (time)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="fu">spread_draws</span>(r_record_id__sigma[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="#cb81-3"></a>  <span class="fu">mutate</span>(<span class="at">r_record_id__sigma =</span> <span class="fu">exp</span>(r_record_id__sigma)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,088,000 × 6
# Groups:   ID, term [386]
      ID term  r_record_id__sigma .chain .iteration .draw
   &lt;int&gt; &lt;chr&gt;              &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
 1     1 day01               1.26      1          1     1
 2     1 day01               1.24      1          2     2
 3     1 day01               1.08      1          3     3
 4     1 day01               1.40      1          4     4
 5     1 day01               1.14      1          5     5
 6     1 day01               1.03      1          6     6
 7     1 day01               1.54      1          7     7
 8     1 day01               1.05      1          8     8
 9     1 day01               1.12      1          9     9
10     1 day01               1.13      1         10    10
# … with 3,087,990 more rows</code></pre>
</div>
</div>
<p>193 * 8000 *2</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="fu">spread_draws</span>(r_record_id__sigma[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb83-3"><a href="#cb83-3"></a>  <span class="fu">mutate</span>(<span class="at">r_record_id__sigma =</span> <span class="fu">exp</span>(r_record_id__sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-4"><a href="#cb83-4"></a>   <span class="fu">median_qi</span>(<span class="at">estimate =</span> r_record_id__sigma) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 386 × 8
      ID term      estimate .lower .upper .width .point .interval
   &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
 1     1 day01        1.19   0.816  1.77    0.95 median qi       
 2     1 Intercept    1.41   1.08   1.84    0.95 median qi       
 3     2 day01        1.55   1.04   2.35    0.95 median qi       
 4     2 Intercept    0.239  0.178  0.322   0.95 median qi       
 5     3 day01        0.829  0.563  1.24    0.95 median qi       
 6     3 Intercept    1.32   1.03   1.74    0.95 median qi       
 7     4 day01        0.971  0.632  1.52    0.95 median qi       
 8     4 Intercept    1.90   1.44   2.52    0.95 median qi       
 9     5 day01        1.14   0.638  2.11    0.95 median qi       
10     5 Intercept    0.431  0.301  0.666   0.95 median qi       
# … with 376 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="fu">spread_draws</span>(r_record_id__sigma[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb85-3"><a href="#cb85-3"></a>  <span class="fu">mutate</span>(<span class="at">r_record_id__sigma =</span> <span class="fu">exp</span>(r_record_id__sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-4"><a href="#cb85-4"></a>   <span class="fu">median_qi</span>(<span class="at">estimate =</span> r_record_id__sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb85-5"><a href="#cb85-5"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"Intercept"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb85-6"><a href="#cb85-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ID, estimate), <span class="at">y =</span> estimate, <span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb85-7"><a href="#cb85-7"></a>   <span class="fu">geom_pointinterval</span>(<span class="at">point_colour =</span> <span class="st">"black"</span>, <span class="at">interval_color =</span> <span class="st">"grey"</span>, <span class="at">point_alpha =</span> .<span class="dv">25</span>) <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="st">"Participants ranked by posterior SD"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"sigma estimate"</span>) <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-52-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2"></a><span class="fu">spread_draws</span>(r_record_id__sigma[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb86-3"><a href="#cb86-3"></a>  <span class="fu">mutate</span>(<span class="at">r_record_id__sigma =</span> <span class="fu">exp</span>(r_record_id__sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-4"><a href="#cb86-4"></a>   <span class="fu">median_qi</span>(<span class="at">estimate =</span> r_record_id__sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb86-5"><a href="#cb86-5"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"day01"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb86-6"><a href="#cb86-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ID, estimate), <span class="at">y =</span> estimate, <span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb86-7"><a href="#cb86-7"></a>   <span class="fu">geom_pointinterval</span>(<span class="at">point_colour =</span> <span class="st">"black"</span>, <span class="at">interval_color =</span> <span class="st">"grey"</span>, <span class="at">point_alpha =</span> .<span class="dv">25</span>) <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="st">"Participants ranked by posterior SD"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"sigma estimate"</span>) <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-53-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>When on the log scale you can more easily see some people are less than average where some are more than average in terms of sigma ::: {.cell}</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>melsm<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="fu">spread_draws</span>(r_record_id__sigma[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3"></a>   <span class="fu">median_qi</span>(<span class="at">estimate =</span> r_record_id__sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb87-4"><a href="#cb87-4"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"day01"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb87-5"><a href="#cb87-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ID, estimate), <span class="at">y =</span> estimate, <span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb87-6"><a href="#cb87-6"></a>   <span class="fu">geom_pointinterval</span>(<span class="at">point_colour =</span> <span class="st">"black"</span>, <span class="at">interval_color =</span> <span class="st">"grey"</span>, <span class="at">point_alpha =</span> .<span class="dv">25</span>) <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="st">"Participants ranked by posterior SD"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"sigma estimate"</span>) <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-54-1.png" width="960"></p>
</div>
<p>:::</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>fits3 <span class="ot">&lt;-</span> newd <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="#cb88-2"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.3</span>)</span>
<span id="cb88-3"><a href="#cb88-3"></a></span>
<span id="cb88-4"><a href="#cb88-4"></a>preds3 <span class="ot">&lt;-</span> newd <span class="sc">%&gt;%</span></span>
<span id="cb88-5"><a href="#cb88-5"></a>  <span class="fu">add_predicted_draws</span>(melsm<span class="fl">.3</span>)</span>
<span id="cb88-6"><a href="#cb88-6"></a></span>
<span id="cb88-7"><a href="#cb88-7"></a>fits3 <span class="sc">%&gt;%</span> </span>
<span id="cb88-8"><a href="#cb88-8"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> N_A.std)) <span class="sc">+</span></span>
<span id="cb88-9"><a href="#cb88-9"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">95</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span><span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb88-10"><a href="#cb88-10"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">data =</span> preds3, <span class="fu">aes</span>(<span class="at">y =</span> .prediction),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb88-11"><a href="#cb88-11"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> newd) <span class="sc">+</span></span>
<span id="cb88-12"><a href="#cb88-12"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>record_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-55-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>preds3 <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3"></a>  <span class="fu">stat_halfeye</span>(<span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb89-4"><a href="#cb89-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>record_id) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>

<img data-src="conditional-5_files/figure-revealjs/unnamed-chunk-56-1.png" width="960" class="r-stretch"><div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          let href = ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>